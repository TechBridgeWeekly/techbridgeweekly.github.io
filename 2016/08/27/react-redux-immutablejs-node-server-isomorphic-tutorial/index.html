<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" >
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
  <title>ä¸€çœ‹å°±æ‡‚çš„ React Server Renderingï¼ˆIsomorphic JavaScriptï¼‰å…¥é–€æ•™å­¸ | TechBridge æŠ€è¡“å…±ç­†éƒ¨è½æ ¼</title>
  <meta name="description" content="TechBridge Weekly æŠ€è¡“é€±åˆŠåœ˜éšŠæ˜¯ä¸€ç¾¤å°ç”¨æŠ€è¡“æ”¹è®Šä¸–ç•Œæ‡·æŠ±ç†±æƒ…çš„åœ˜éšŠã€‚æœ¬æŠ€è¡“å…±ç­†éƒ¨è½æ ¼åˆæœŸå°ˆæ³¨æ–¼Webå‰å¾Œç«¯ã€è¡Œå‹•ç¶²è·¯ã€æ©Ÿå™¨äºº/ç‰©è¯ç¶²ã€æ•¸æ“šåˆ†æèˆ‡ç”¢å“è¨­è¨ˆç­‰æŠ€è¡“åˆ†äº«" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="MobileOptimized" content="320" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <!-- google-site-verification -->
  <meta name="google-site-verification" content="WX_9sZlrIYOEpy8RR7zCoa7-pJk611zZt11BSBUcDVY" />
  <link rel="stylesheet preload" type="text/css" href="/css/screen.css" as="style" />
  <link rel="stylesheet preload" type="text/css" href="//fonts.googleapis.com/css?family=Noto+Serif:400,700,400italic|Open+Sans:700,400" as="style" />

  <!-- Favicons -->
  <link rel="apple-touch-icon" href="/img/favicon.ico">
  <link rel="icon preload" href="/img/favicon.ico" as="image">

  
  
  <link rel="alternate" type="application/atom+xml" title="Atom 0.3" href="atom.xml">
  
  

  
</head>


<body class="post-template">

  <header class="site-head" >
    <div class="vertical">
        <div class="site-head-content inner">
             <a class="blog-logo" href="/"><img src="/img/logo-tb-500-500.png" alt="Blog Logo"/></a> 
            <h1 class="blog-title">TechBridge æŠ€è¡“å…±ç­†éƒ¨è½æ ¼</h1>
            <h2 class="blog-description">var topics = ['Webå‰å¾Œç«¯', 'è¡Œå‹•ç¶²è·¯', 'æ©Ÿå™¨äºº/ç‰©è¯ç¶²', 'æ•¸æ“šåˆ†æ', 'ç”¢å“è¨­è¨ˆ', 'etc.']</h2>
            <div class="navbar-block">
                <span><a href="/">é¦–é </a></span> / <span><a href="/about/">é—œæ–¼æˆ‘å€‘</a></span> / <span><a href="http://weekly.techbridge.cc/" target="_blank">æŠ€è¡“é€±åˆŠ</a></span> / <span><a href="https://www.facebook.com/techbridge.cc/" target="_blank">ç²‰çµ²å°ˆé </a></span> / <span><a href="/atom.xml" target="_blank">è¨‚é–±RSS </a></span>
                <br>
            </div>
        </div>
    </div>
</header>
  

<main class="content" role="main">
  <article class="post">
    <span class="post-meta">
      <time datetime="2016-08-27T23:26:00.000Z" itemprop="datePublished">
          2016-08-27
      </time>
    
    
    | 
    <a href='/tags/React-Redux-Server-Rendering-Isomorphic-JavaScript-Node-Express-Universal-JavaScript-Isomorphic-JavaScript/'>React, Redux, Server Rendering, Isomorphic, JavaScript, Node, Express, Universal JavaScript, Isomorphic JavaScript</a>
    
    
</span>

<meta name="generator" content="ä¸€çœ‹å°±æ‡‚çš„ React Server Renderingï¼ˆIsomorphic JavaScriptï¼‰å…¥é–€æ•™å­¸">
<meta name="og:title" content="ä¸€çœ‹å°±æ‡‚çš„ React Server Renderingï¼ˆIsomorphic JavaScriptï¼‰å…¥é–€æ•™å­¸">
<meta name="og:description" content="TechBridge Weekly æŠ€è¡“é€±åˆŠåœ˜éšŠæ˜¯ä¸€ç¾¤å°ç”¨æŠ€è¡“æ”¹è®Šä¸–ç•Œæ‡·æŠ±ç†±æƒ…çš„åœ˜éšŠã€‚æœ¬æŠ€è¡“å…±ç­†éƒ¨è½æ ¼åˆæœŸå°ˆæ³¨æ–¼Webå‰å¾Œç«¯ã€è¡Œå‹•ç¶²è·¯ã€æ©Ÿå™¨äºº/ç‰©è¯ç¶²ã€æ•¸æ“šåˆ†æèˆ‡ç”¢å“è¨­è¨ˆç­‰æŠ€è¡“åˆ†äº«ã€‚">
<meta name="og:type" content="website">
<meta name="og:image" content="/img/og-cover.png">

    <h1 class="post-title">ä¸€çœ‹å°±æ‡‚çš„ React Server Renderingï¼ˆIsomorphic JavaScriptï¼‰å…¥é–€æ•™å­¸</h1>
    <section class="post-content">
      <div class="fb-like" data-href="https://www.facebook.com/techbridge.cc" data-layout="button_count" data-action="like" data-size="large" data-show-faces="false" data-share="true"></div>   
      <hr>
      <p><img src="/img/kdchang/isomorphic-javascript.png" alt="React Redux Sever Renderingï¼ˆIsomorphicï¼‰å…¥é–€" title="React Redux Sever Renderingï¼ˆIsomorphicï¼‰å…¥é–€"></p>
<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ç”±æ–¼å¯èƒ½æœ‰äº›è®€è€…æ²’è½é <a target="_blank" rel="noopener" href="http://isomorphic.net/">Isomorphic JavaScript</a> ã€‚å› æ­¤åœ¨é€²åˆ°é–‹ç™¼ React Redux Sever Rendering æ‡‰ç”¨ç¨‹å¼çš„ä¸»é¡Œä¹‹å‰æˆ‘å€‘å…ˆä¾†èŠèŠ Isomorphic JavaScript é€™å€‹è­°é¡Œã€‚</p>
<p>æ ¹æ“š <a target="_blank" rel="noopener" href="http://isomorphic.net/">Isomorphic JavaScript</a> é€™å€‹ç¶²ç«™çš„èªªæ˜ï¼š</p>
<blockquote>
<p>Isomorphic JavaScript apps are JavaScript applications that can run both client-side and server-side.<br>The backend and frontend share the same code. </p>
</blockquote>
<p>Isomorphic JavaScript ä¿‚æŒ‡ç€è¦½å™¨ç«¯å’Œä¼ºæœå™¨ç«¯å…±ç”¨ JavaScript çš„ç¨‹å¼ç¢¼ã€‚</p>
<p>å¦å¤–ï¼Œé™¤äº† Isomorphic JavaScript å¤–ï¼Œè®€è€…æˆ–è¨±ä¹Ÿæœ‰è½é Universal JavaScript é€™å€‹ç”¨è©ã€‚é‚£ä»€éº¼æ˜¯ Universal JavaScript å‘¢ï¼Ÿå®ƒå’Œ Isomorphic JavaScript æ˜¯æŒ‡ä¸€æ¨£çš„æ„æ€å—ï¼Ÿé‡å°é€™å€‹è­°é¡Œç¶²è·¯ä¸Šæœ‰äº›é–‹ç™¼è€…æå‡ºäº†è‡ªå·±çš„è§€é»ï¼š <a target="_blank" rel="noopener" href="https://medium.com/@mjackson/universal-javascript-4761051b7ae9#.67xsay73m">Universal JavaScript</a>ã€<a target="_blank" rel="noopener" href="https://medium.com/@ghengeveld/isomorphism-vs-universal-javascript-4b47fb481beb#.qvggcp3v8">Isomorphism vs Universal JavaScript</a>ã€‚å…¶ä¸­ Isomorphism vs Universal JavaScript é€™ç¯‡æ–‡ç« çš„ä½œè€… Gert Hengeveld æŒ‡å‡º <code>Isomorphic JavaScript</code> ä¸»è¦æ˜¯æŒ‡å‰å¾Œç«¯å…±ç”¨ JavaScript çš„é–‹ç™¼æ–¹å¼ï¼Œè€Œ <code>Universal JavaScript</code> æ˜¯æŒ‡ JavaScript ç¨‹å¼ç¢¼å¯ä»¥åœ¨ä¸åŒç’°å¢ƒä¸‹é‹è¡Œï¼Œé€™ç•¶ç„¶åŒ…å«ç€è¦½å™¨ç«¯å’Œä¼ºæœå™¨ç«¯ï¼Œç”šè‡³å…¶ä»–ç’°å¢ƒã€‚ä¹Ÿå°±æ˜¯èªª <code>Universal JavaScript</code> åœ¨æ„ç¾©ä¸Šå¯ä»¥æ¶µè“‹çš„æ¯” <code>Isomorphic JavaScript</code> æ›´å»£æ³›ä¸€äº›ï¼Œç„¶è€Œåœ¨ Github æˆ–æ˜¯è¨±å¤šæŠ€è¡“è¨è«–ä¸Šé€šå¸¸æœƒæŠŠå…©è€…è¦–ç‚ºåŒä¸€ä»¶äº‹æƒ…ï¼Œé€™éƒ¨ä»½ä¹Ÿè«‹è®€è€…ç•™æ„ã€‚</p>
<h2 id="Isomorphic-JavaScript-çš„å¥½è™•"><a href="#Isomorphic-JavaScript-çš„å¥½è™•" class="headerlink" title="Isomorphic JavaScript çš„å¥½è™•"></a>Isomorphic JavaScript çš„å¥½è™•</h2><p>åœ¨é–‹å§‹çœŸæ­£æ’°å¯« Isomorphic JavaScript å‰æˆ‘å€‘åœ¨é€²ä¸€æ­¥æ¢è¨ä½¿ç”¨ Isomorphic JavaScript æœ‰å“ªäº›å¥½è™•ï¼Ÿåœ¨è«‡å¥½è™•ä¹‹å‰ï¼Œæˆ‘å€‘å…ˆçœ‹çœ‹æœ€æ—© Web é–‹ç™¼æ˜¯å¦‚ä½•è™•ç†é é¢æ¸²æŸ“å’Œ state ç®¡ç†ï¼Œé‚„æœ‰é‡åˆ°å“ªäº›æŒ‘æˆ°ã€‚</p>
<p>æœ€æ—©çš„æ™‚å€™æˆ‘å€‘è«‡è«– Web å¾ˆå–®ç´”ï¼Œéƒ½æ˜¯ç”± Server ç«¯é€²è¡Œæ¨¡ç‰ˆçš„è™•ç†ï¼Œä½ å¯ä»¥æƒ³æˆ template æ˜¯ä¸€å€‹å‡½æ•¸ï¼Œæˆ‘å€‘å‚³é€è³‡æ–™é€²å»ï¼Œtemplate æœ€å¾Œç”¢ç”Ÿä¸€å¼µ HTML çµ¦ç€è¦½å™¨é¡¯ç¤ºã€‚ä¾‹å¦‚ï¼šNode ä½¿ç”¨çš„ï¼ˆ<a target="_blank" rel="noopener" href="http://ejs.co/">EJS</a>ã€<a target="_blank" rel="noopener" href="http://jade-lang.com/">Jade</a>ï¼‰ã€Python&#x2F;Django çš„ <a target="_blank" rel="noopener" href="https://docs.djangoproject.com/el/1.10/ref/templates/">Template</a> æˆ–æ›¿ä»£æ–¹æ¡ˆ <a target="_blank" rel="noopener" href="https://github.com/pallets/jinja">Jinja</a>ã€PHP çš„ <a target="_blank" rel="noopener" href="http://www.smarty.net/">Smarty</a>ã€<a target="_blank" rel="noopener" href="https://laravel.com/">Laravel</a> ä½¿ç”¨çš„ <a target="_blank" rel="noopener" href="https://laravel.com/docs/5.0/templates">Blade</a>ï¼Œç”šè‡³æ˜¯ Ruby on Rails ç”¨çš„ <a target="_blank" rel="noopener" href="http://guides.rubyonrails.org/layouts_and_rendering.html">ERB</a>ã€‚éƒ½æ˜¯ç”±å¾Œç«¯å» render æ‰€æœ‰è³‡æ–™å’Œé é¢ï¼Œå‰ç«¯è™•ç†ç›¸å°å–®ç´”ã€‚</p>
<p>ç„¶è€Œéš¨è‘—å‰ç«¯å·¥ç¨‹çš„è»Ÿé«”å·¥ç¨‹åŒ–å’Œä½¿ç”¨è€…é«”é©—çš„è¦æ±‚ï¼Œé–‹å§‹å‡ºç¾å„å¼å‰ç«¯æ¡†æ¶çš„ç™¾èŠ±é½Šæ”¾ï¼Œä¾‹å¦‚ï¼š<a target="_blank" rel="noopener" href="http://backbonejs.org/">Backbone.js</a>ã€<a target="_blank" rel="noopener" href="http://emberjs.com/">Ember.js</a> å’Œ <a target="_blank" rel="noopener" href="https://angularjs.org/">Angular.js</a> ç­‰å‰ç«¯ MVC (Model-View-Controller) æˆ– MVVM (Model-View-ViewModel) æ¡†æ¶ï¼Œå°‡é é¢æ–¼å‰ç«¯æ¸²æŸ“çš„ä¸åˆ·é å–®é å¼æ‡‰ç”¨ç¨‹å¼ï¼ˆSingle Page Appï¼‰ä¹Ÿå› æ­¤é–‹å§‹æµè¡Œã€‚</p>
<p>å¾Œç«¯é™¤äº†æä¾›åˆå§‹çš„ HTML å¤–ï¼Œé‚„æä¾› API Server è®“å‰ç«¯æ¡†æ¶å¯ä»¥å–å¾—è³‡æ–™ç”¨æ–¼å‰ç«¯ templateã€‚è¤‡é›œçš„é‚è¼¯ç”± ViewModel&#x2F;Presenter ä¾†è™•ç†ï¼Œå‰ç«¯ template åªè™•ç†ç°¡å–®çš„æ˜¯å¦é¡¯ç¤ºæˆ–æ˜¯å…ƒç´ è¿­ä»£çš„ç‹€æ³ï¼Œå¦‚ä¸‹åœ–æ‰€ç¤ºï¼š</p>
<p><img src="/img/kdchang/client-mvc.png" alt="React Redux Sever Renderingï¼ˆIsomorphicï¼‰å…¥é–€" title="React Redux Sever Renderingï¼ˆIsomorphicï¼‰å…¥é–€"></p>
<p>ç„¶è€Œå‰ç«¯æ¸²æŸ“ template é›–ç„¶æœ‰å®ƒçš„å¥½è™•ä½†ä¹Ÿé‡åˆ°ä¸€äº›å•é¡ŒåŒ…æ‹¬æ•ˆèƒ½ã€SEO ç­‰è­°é¡Œã€‚æ­¤æ™‚æˆ‘å€‘å°±é–‹å§‹æ€è€ƒ Isomorphic JavaScript çš„å¯èƒ½æ€§ï¼šç‚ºä»€éº¼æˆ‘å€‘ä¸èƒ½å‰å¾Œç«¯éƒ½ä½¿ç”¨ JavaScript ç”šè‡³æ˜¯ Reactï¼Ÿ</p>
<p><img src="/img/kdchang/isomorphic-api.png" alt="React Redux Sever Renderingï¼ˆIsomorphicï¼‰å…¥é–€" title="React Redux Sever Renderingï¼ˆIsomorphicï¼‰å…¥é–€"></p>
<p>äº‹å¯¦ä¸Šï¼ŒReact çš„å„ªå‹¢å°±åœ¨æ–¼å®ƒå¯ä»¥å¾ˆå„ªé›…åœ°å¯¦ç¾ Server Side Rendering é”åˆ° Isomorphic JavaScript çš„æ•ˆæœã€‚åœ¨ <code>react-dom/server</code> ä¸­æœ‰å…©å€‹æ–¹æ³• <code>renderToString</code> å’Œ <code>renderToStaticMarkup</code> å¯ä»¥åœ¨ server ç«¯æ¸²æŸ“ä½ çš„ componentsã€‚å…¶ä¸»è¦éƒ½æ˜¯å°‡ React Component åœ¨ Server ç«¯è½‰æˆ DOM Stringï¼Œä¹Ÿå¯ä»¥å°‡ props å¾€ä¸‹å‚³ï¼Œç„¶è€Œäº‹ä»¶è™•ç†æœƒå¤±æ•ˆï¼Œè¦åˆ° client-side çš„ React æ¥æ”¶åˆ°å¾Œæ‰æœƒæŠŠå®ƒåŠ ä¸Šå»ï¼ˆä½†è¦æ³¨æ„ server-side å’Œ client-side çš„ checksum è¦ä¸€è‡´ä¸ç„¶æœƒå‡ºç¾éŒ¯èª¤ï¼‰ï¼Œé€™æ¨£ä¸€ä¾†å¯ä»¥æé«˜æ¸²æŸ“é€Ÿåº¦å’Œ SEO æ•ˆæœã€‚<code>renderToString</code> å’Œ <code>renderToStaticMarkup</code> æœ€å¤§çš„å·®ç•°åœ¨æ–¼ <code>renderToStaticMarkup</code> æœƒå°‘åŠ ä¸€äº› React å…§éƒ¨ä½¿ç”¨çš„ DOM å±¬æ€§ï¼Œä¾‹å¦‚ï¼š<code>data-react-id</code>ï¼Œå› æ­¤å¯ä»¥ç¯€çœä¸€äº›è³‡æºã€‚</p>
<p>ä½¿ç”¨ <code>renderToString</code> é€²è¡Œ Server ç«¯æ¸²æŸ“ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOMServer</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom/server&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title class_">ReactDOMServer</span>.<span class="title function_">renderToString</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">HelloButton</span> <span class="attr">name</span>=<span class="string">&quot;Mark&quot;</span> /&gt;</span></span>);</span><br></pre></td></tr></table></figure>

<p>æ¸²æŸ“å‡ºä¾†çš„æ•ˆæœï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">data-reactid</span>=<span class="string">&quot;.7&quot;</span> <span class="attr">data-react-checksum</span>=<span class="string">&quot;762752829&quot;</span>&gt;</span></span><br><span class="line">  Hello, Mark</span><br><span class="line"><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ç¸½çš„ä¾†èªªä½¿ç”¨ Isomorphic JavaScript æœƒæœ‰ä»¥ä¸‹çš„å¥½è™•ï¼š</p>
<ol>
<li>æœ‰åŠ©æ–¼ SEO</li>
<li>Rendering é€Ÿåº¦è¼ƒå¿«ï¼Œæ•ˆèƒ½è¼ƒä½³</li>
<li>æ”¾æ£„è¹©è…³çš„ Template èªæ³•æ“æŠ± Component å…ƒä»¶åŒ–æ€è€ƒï¼Œä¾¿æ–¼ç¶­è­·</li>
<li>ç›¡é‡å‰å¾Œç«¯å…±ç”¨ç¨‹å¼ç¢¼ç¯€çœé–‹ç™¼æ™‚é–“</li>
</ol>
<p>ä¸éè¦æ³¨æ„çš„æ˜¯å¦‚æœæœ‰ä½¿ç”¨ Redux åœ¨ Server Side Rendering ä¸­ï¼Œå…¶æµç¨‹ç›¸å°è¤‡é›œï¼Œä¸éå¤§è‡´æµç¨‹å¦‚ä¸‹ï¼š<br>ç”±å¾Œç«¯é å…ˆè¼‰å…¥éœ€è¦çš„ initialStateï¼Œç”±æ–¼ Server æ¸²æŸ“å¿…é ˆå…¨éƒ¨éƒ½è½‰æˆ stringï¼Œæ‰€ä»¥å…ˆå°‡ state å…ˆ dehydrationï¼ˆè„«æ°´ï¼‰ï¼Œç­‰åˆ° client ç«¯å† rehydrationï¼ˆè¦†æ°´ï¼‰ï¼Œé‡å»º store å¾€ä¸‹å‚³åˆ°å‰ç«¯çš„ React Componentã€‚</p>
<p>è€Œè¦æŠŠè³‡æ–™å¾ä¼ºæœå™¨ç«¯å‚³éåˆ°å®¢æˆ¶ç«¯ï¼Œæˆ‘å€‘éœ€è¦ï¼š</p>
<ol>
<li>æŠŠå–å¾—åˆå§‹ state ç•¶åšåƒæ•¸ä¸¦å°æ¯å€‹è«‹æ±‚å»ºç«‹ä¸€å€‹å…¨æ–°çš„ Redux store å¯¦é«”</li>
<li>é¸æ“‡æ€§åœ° dispatch ä¸€äº› action </li>
<li>æŠŠ state å¾ store å–å‡ºä¾†</li>
<li>æŠŠ state ä¸€èµ·å‚³åˆ°å®¢æˆ¶ç«¯</li>
</ol>
<p>æ¥ä¸‹ä¾†æˆ‘å€‘å°±é–‹å§‹å‹•æ‰‹å¯¦ä½œä¸€å€‹ç°¡å–®çš„ React Server Side Rendering Counter æ‡‰ç”¨ç¨‹å¼ã€‚</p>
<h2 id="å°ˆæ¡ˆæˆæœæˆªåœ–"><a href="#å°ˆæ¡ˆæˆæœæˆªåœ–" class="headerlink" title="å°ˆæ¡ˆæˆæœæˆªåœ–"></a>å°ˆæ¡ˆæˆæœæˆªåœ–</h2><p><img src="/img/kdchang/react-server-rendering-demo.png" alt="React Redux Sever Renderingï¼ˆIsomorphicï¼‰å…¥é–€" title="React Redux Sever Renderingï¼ˆIsomorphicï¼‰å…¥é–€"></p>
<h2 id="ç’°å¢ƒå®‰è£èˆ‡è¨­å®š"><a href="#ç’°å¢ƒå®‰è£èˆ‡è¨­å®š" class="headerlink" title="ç’°å¢ƒå®‰è£èˆ‡è¨­å®š"></a>ç’°å¢ƒå®‰è£èˆ‡è¨­å®š</h2><ol>
<li><p>å®‰è£ Node å’Œ NPM</p>
</li>
<li><p>å®‰è£æ‰€éœ€å¥—ä»¶</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install --save react react-dom redux react-redux react-router immutable redux-immutable redux-actions redux-thunk babel-polyfill babel-register body-parser express morgan qs</span><br></pre></td></tr></table></figure>

 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install --save-dev babel-core babel-eslint babel-loader babel-preset-es2015 babel-preset-react babel-preset-stage-1 eslint eslint-config-airbnb eslint-loader eslint-plugin-import eslint-plugin-jsx-a11y eslint-plugin-react html-webpack-plugin webpack webpack-dev-server redux-logger</span><br></pre></td></tr></table></figure></li>
</ol>
<p>æ¥ä¸‹ä¾†æˆ‘å€‘å…ˆè¨­å®šä¸€ä¸‹é–‹ç™¼æ–‡æª”ã€‚</p>
<ol>
<li><p>è¨­å®š Babel çš„è¨­å®šæª”ï¼š <code>.babelrc</code></p>
 <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	<span class="string">&quot;presets&quot;</span>: [</span><br><span class="line">  	<span class="string">&quot;es2015&quot;</span>,</span><br><span class="line">  	<span class="string">&quot;react&quot;</span>,</span><br><span class="line"> 	],</span><br><span class="line">	<span class="string">&quot;plugins&quot;</span>: []</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>è¨­å®š ESLint çš„è¨­å®šæª”å’Œè¦å‰‡ï¼š <code>.eslintrc</code></p>
 <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;extends&quot;</span>: <span class="string">&quot;airbnb&quot;</span>,</span><br><span class="line">  <span class="string">&quot;rules&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;react/jsx-filename-extension&quot;</span>: [<span class="number">1</span>, &#123; <span class="string">&quot;extensions&quot;</span>: [<span class="string">&quot;.js&quot;</span>, <span class="string">&quot;.jsx&quot;</span>] &#125;],</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;env&quot;</span> :&#123;</span><br><span class="line">    <span class="string">&quot;browser&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>è¨­å®š Webpack è¨­å®šæª”ï¼š <code>webpack.config.js</code></p>
 <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è®“ä½ å¯ä»¥å‹•æ…‹æ’å…¥ bundle å¥½çš„ .js æª”åˆ° .index.html</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">HtmlWebpackPlugin</span> = <span class="built_in">require</span>(<span class="string">&#x27;html-webpack-plugin&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">HTMLWebpackPluginConfig</span> = <span class="keyword">new</span> <span class="title class_">HtmlWebpackPlugin</span>(&#123;</span><br><span class="line">  <span class="attr">template</span>: <span class="string">`<span class="subst">$&#123;__dirname&#125;</span>/src/index.html`</span>,</span><br><span class="line">  <span class="attr">filename</span>: <span class="string">&#x27;index.html&#x27;</span>,</span><br><span class="line">  <span class="attr">inject</span>: <span class="string">&#x27;body&#x27;</span>,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// entry ç‚ºé€²å…¥é»ï¼Œoutput ç‚ºé€²è¡Œå®Œ eslintã€babel loader è½‰è­¯å¾Œçš„æª”æ¡ˆä½ç½®</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">entry</span>: [</span><br><span class="line">    <span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">`<span class="subst">$&#123;__dirname&#125;</span>/dist`</span>,</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&#x27;index_bundle.js&#x27;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">module</span>: &#123;</span><br><span class="line">    <span class="attr">preLoaders</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">test</span>: <span class="regexp">/\.jsx$|\.js$/</span>,</span><br><span class="line">        <span class="attr">loader</span>: <span class="string">&#x27;eslint-loader&#x27;</span>,</span><br><span class="line">        <span class="attr">include</span>: <span class="string">`<span class="subst">$&#123;__dirname&#125;</span>/src`</span>,</span><br><span class="line">        <span class="attr">exclude</span>: <span class="regexp">/bundle\.js$/</span></span><br><span class="line">      &#125;</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">loaders</span>: [&#123;</span><br><span class="line">      <span class="attr">test</span>: <span class="regexp">/\.js$/</span>,</span><br><span class="line">      <span class="attr">exclude</span>: <span class="regexp">/node_modules/</span>,</span><br><span class="line">      <span class="attr">loader</span>: <span class="string">&#x27;babel-loader&#x27;</span>,</span><br><span class="line">      <span class="attr">query</span>: &#123;</span><br><span class="line">        <span class="attr">presets</span>: [<span class="string">&#x27;es2015&#x27;</span>, <span class="string">&#x27;react&#x27;</span>],</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;],</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// å•Ÿå‹•é–‹ç™¼æ¸¬è©¦ç”¨ server è¨­å®šï¼ˆä¸èƒ½ç”¨åœ¨ productionï¼‰</span></span><br><span class="line">  <span class="attr">devServer</span>: &#123;</span><br><span class="line">    <span class="attr">inline</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">port</span>: <span class="number">8008</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">plugins</span>: [<span class="title class_">HTMLWebpackPluginConfig</span>],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
</ol>
<p>å¤ªå¥½äº†ï¼é€™æ¨£æˆ‘å€‘å°±å®Œæˆäº†é–‹ç™¼ç’°å¢ƒçš„è¨­å®šå¯ä»¥é–‹å§‹å‹•æ‰‹å¯¦ä½œ <code>React Server Side Rendering Counter</code> æ‡‰ç”¨ç¨‹å¼äº†ï¼	</p>
<p>å…ˆçœ‹ä¸€ä¸‹æˆ‘å€‘æ•´å€‹å°ˆæ¡ˆçš„è³‡æ–™çµæ§‹ï¼Œæˆ‘å€‘æŠŠæ•´å€‹å°ˆæ¡ˆåˆ†æˆä¸‰å€‹ä¸»è¦çš„è³‡æ–™å¤¾ï¼ˆ<code>client</code>ã€<code>server</code>ï¼Œé‚„æœ‰å…±ç”¨ç¨‹å¼ç¢¼çš„ <code>common</code>ï¼‰ï¼š</p>
<p><img src="/img/kdchang/react-server-rendering-folder.png" alt="React Redux Sever Renderingï¼ˆIsomorphicï¼‰å…¥é–€" title="React Redux Sever Renderingï¼ˆIsomorphicï¼‰å…¥é–€"></p>
<h2 id="å‹•æ‰‹å¯¦ä½œ"><a href="#å‹•æ‰‹å¯¦ä½œ" class="headerlink" title="å‹•æ‰‹å¯¦ä½œ"></a>å‹•æ‰‹å¯¦ä½œ</h2><p>é¦–å…ˆï¼Œæˆ‘å€‘å…ˆå®šç¾©äº† <code>client</code> çš„ <code>index.js</code>ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¼•ç”¨ babel-polyfill é¿å…ç€è¦½å™¨ä¸æ”¯æ´éƒ¨åˆ† ES6 ç”¨æ³•</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;babel-polyfill&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Provider</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-redux&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">CounterContainer</span> <span class="keyword">from</span> <span class="string">&#x27;../common/containers/CounterContainer&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> configureStore <span class="keyword">from</span> <span class="string">&#x27;../common/store/configureStore&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; fromJS &#125; <span class="keyword">from</span> <span class="string">&#x27;immutable&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¾ server å–å¾—å‚³é€²ä¾†çš„ initialStateã€‚ç”±æ–¼å¾å­—ä¸²è½‰å›ç‰©ä»¶ï¼Œåˆç¨±ç‚º rehydrationï¼ˆè¦†æ°´ï¼‰ </span></span><br><span class="line"><span class="keyword">const</span> initialState = <span class="variable language_">window</span>.<span class="property">__PRELOADED_STATE__</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”±æ–¼æˆ‘å€‘ä½¿ç”¨ ImmutableJSï¼Œæ‰€ä»¥éœ€è¦æŠŠåœ¨ server-side dehydrationï¼ˆè„«æ°´ï¼‰åˆåœ¨å‰ç«¯ rehydrationï¼ˆè¦†æ°´ï¼‰çš„ initialState è½‰æˆ ImmutableJS è³‡æ–™å‹æ…‹ï¼Œä¸¦å‚³é€² configureStore å»ºç«‹ store</span></span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">configureStore</span>(<span class="title function_">fromJS</span>(initialState));</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¥ä¸‹ä¾†å°±è·Ÿä¸€èˆ¬çš„ React App ä¸€æ¨£ï¼ŒæŠŠ store é€é Provider å¾€ä¸‹å‚³åˆ° Component ä¸­</span></span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">Provider</span> <span class="attr">store</span>=<span class="string">&#123;store&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">CounterContainer</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">Provider</span>&gt;</span></span>,</span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;app&#x27;</span>)</span><br><span class="line">);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç”±æ–¼ Node ç«¯è¦åˆ°æ–°ç‰ˆå°æ–¼ ES6 æ”¯æ´è¼ƒå¥½ï¼Œæ‰€ä»¥å…ˆç”¨ <code>babel-register</code> åœ¨ <code>src/server/index.js</code> å»å³æ™‚è½‰è­¯ <code>server.js</code>ï¼Œä½†ç›®å‰ä¸å»ºè­°åœ¨ <code>production</code> ç’°å¢ƒä½¿ç”¨ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// use babel-register to precompile ES6 syntax</span></span><br><span class="line"><span class="built_in">require</span>(<span class="string">&#x27;babel-register&#x27;</span>);</span><br><span class="line"><span class="built_in">require</span>(<span class="string">&#x27;./server&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>æ¥è‘—æ˜¯æˆ‘å€‘ <code>server</code> ç«¯ï¼Œä¹Ÿæ˜¯é€™å€‹ç¯„ä¾‹æœ€é‡è¦çš„ä¸€å€‹éƒ¨åˆ†ã€‚é¦–å…ˆæˆ‘å€‘ç”¨ <code>express</code> å»ºç«‹äº†ä¸€å€‹ port ç‚º 3000 çš„ serverï¼Œä¸¦ä½¿ç”¨ webpack å»åŸ·è¡Œ <code>client</code> çš„ç¨‹å¼ç¢¼ã€‚é€™å€‹ç¯„ä¾‹ä¸­æˆ‘å€‘ä½¿ç”¨äº† <code>handleRender</code> ç•¶ request é€²ä¾†æ™‚ï¼ˆç›´æ¥æ‹œè¨ªé é¢æˆ–é‡æ–°æ•´ç†ï¼‰å°±æœƒåŸ·è¡Œ fetchCounter() é€²è¡Œè™•ç†ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Express</span> <span class="keyword">from</span> <span class="string">&#x27;express&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> qs <span class="keyword">from</span> <span class="string">&#x27;qs&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> webpack <span class="keyword">from</span> <span class="string">&#x27;webpack&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> webpackDevMiddleware <span class="keyword">from</span> <span class="string">&#x27;webpack-dev-middleware&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> webpackHotMiddleware <span class="keyword">from</span> <span class="string">&#x27;webpack-hot-middleware&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> webpackConfig <span class="keyword">from</span> <span class="string">&#x27;../webpack.config&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; renderToString &#125; <span class="keyword">from</span> <span class="string">&#x27;react-dom/server&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Provider</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-redux&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; fromJS &#125; <span class="keyword">from</span> <span class="string">&#x27;immutable&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> configureStore <span class="keyword">from</span> <span class="string">&#x27;../common/store/configureStore&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">CounterContainer</span> <span class="keyword">from</span> <span class="string">&#x27;../common/containers/CounterContainer&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; fetchCounter &#125; <span class="keyword">from</span> <span class="string">&#x27;../common/api/counter&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> <span class="title class_">Express</span>();</span><br><span class="line"><span class="keyword">const</span> port = <span class="number">3000</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">handleRender</span>(<span class="params">req, res</span>) &#123;</span><br><span class="line">  <span class="comment">// æ¨¡ä»¿å¯¦éš›éåŒæ­¥ api è™•ç†æƒ…å½¢</span></span><br><span class="line">  <span class="title function_">fetchCounter</span>(<span class="function"><span class="params">apiResult</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// è®€å– api æä¾›çš„è³‡æ–™ï¼ˆé€™é‚Šæˆ‘å€‘ api æ˜¯ç”¨ setTimeout é€²è¡Œæ¨¡ä»¿éåŒæ­¥ç‹€æ³ï¼‰ï¼Œè‹¥ç¶²å€åƒæ•¸æœ‰å€¼æ“‡å–å€¼ï¼Œè‹¥ç„¡å‰‡ä½¿ç”¨ api æä¾›çš„éš¨æ©Ÿå€¼ï¼Œè‹¥éƒ½æ²’æœ‰å‰‡å– 0</span></span><br><span class="line">    <span class="keyword">const</span> params = qs.<span class="title function_">parse</span>(req.<span class="property">query</span>);</span><br><span class="line">    <span class="keyword">const</span> counter = <span class="built_in">parseInt</span>(params.<span class="property">counter</span>, <span class="number">10</span>) || apiResult || <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// å°‡ initialState è½‰æˆ immutable å’Œç¬¦åˆ state è¨­è¨ˆçš„æ ¼å¼ </span></span><br><span class="line">    <span class="keyword">const</span> initialState = <span class="title function_">fromJS</span>(&#123;</span><br><span class="line">      <span class="attr">counterReducers</span>: &#123;</span><br><span class="line">        <span class="attr">count</span>: counter,</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">// å»ºç«‹ä¸€å€‹ redux store</span></span><br><span class="line">    <span class="keyword">const</span> store = <span class="title function_">configureStore</span>(initialState);</span><br><span class="line">    <span class="comment">// ä½¿ç”¨ renderToString å°‡ component è½‰ç‚º string</span></span><br><span class="line">    <span class="keyword">const</span> html = <span class="title function_">renderToString</span>(</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">Provider</span> <span class="attr">store</span>=<span class="string">&#123;store&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">CounterContainer</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Provider</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">    <span class="comment">// å¾å»ºç«‹çš„ redux store ä¸­å–å¾— initialState</span></span><br><span class="line">    <span class="keyword">const</span> finalState = store.<span class="title function_">getState</span>();</span><br><span class="line">    <span class="comment">// å°‡ HTML å’Œ initialState å‚³åˆ° client-side</span></span><br><span class="line">    res.<span class="title function_">send</span>(<span class="title function_">renderFullPage</span>(html, finalState));</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// HTML Markupï¼ŒåŒæ™‚ä¹ŸæŠŠ preloadedState è½‰æˆå­—ä¸²ï¼ˆstringifyï¼‰å‚³åˆ° client-sideï¼Œåˆç¨±ç‚º dehydrationï¼ˆè„«æ°´ï¼‰</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">renderFullPage</span>(<span class="params">html, preloadedState</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;!doctype html&gt;</span></span><br><span class="line"><span class="string">    &lt;html&gt;</span></span><br><span class="line"><span class="string">      &lt;head&gt;</span></span><br><span class="line"><span class="string">        &lt;title&gt;Redux Universal Example&lt;/title&gt;</span></span><br><span class="line"><span class="string">      &lt;/head&gt;</span></span><br><span class="line"><span class="string">      &lt;body&gt;</span></span><br><span class="line"><span class="string">        &lt;div id=&quot;app&quot;&gt;<span class="subst">$&#123;html&#125;</span>&lt;/div&gt;</span></span><br><span class="line"><span class="string">        &lt;script&gt;</span></span><br><span class="line"><span class="string">          window.__PRELOADED_STATE__ = <span class="subst">$&#123;<span class="built_in">JSON</span>.stringify(preloadedState).replace(/&lt;/g, <span class="string">&#x27;\\x3c&#x27;</span>)&#125;</span></span></span><br><span class="line"><span class="string">        &lt;/script&gt;</span></span><br><span class="line"><span class="string">        &lt;script src=&quot;/static/bundle.js&quot;&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string">      &lt;/body&gt;</span></span><br><span class="line"><span class="string">    &lt;/html&gt;</span></span><br><span class="line"><span class="string">    `</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ middleware æ–¼ webpack å»é€²è¡Œ hot module reloading </span></span><br><span class="line"><span class="keyword">const</span> compiler = <span class="title function_">webpack</span>(webpackConfig);</span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">webpackDevMiddleware</span>(compiler, &#123; <span class="attr">noInfo</span>: <span class="literal">true</span>, <span class="attr">publicPath</span>: webpackConfig.<span class="property">output</span>.<span class="property">publicPath</span> &#125;));</span><br><span class="line">app.<span class="title function_">use</span>(<span class="title function_">webpackHotMiddleware</span>(compiler));</span><br><span class="line"><span class="comment">// æ¯æ¬¡ server æ¥åˆ° request éƒ½æœƒå‘¼å« handleRender</span></span><br><span class="line">app.<span class="title function_">use</span>(handleRender);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç›£è½ server ç‹€æ³</span></span><br><span class="line">app.<span class="title function_">listen</span>(port, <span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (error) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(error)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">info</span>(<span class="string">`==&gt; ğŸŒ  Listening on port <span class="subst">$&#123;port&#125;</span>. Open up http://localhost:<span class="subst">$&#123;port&#125;</span>/ in your browser.`</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>è™•ç†å®Œ Server çš„éƒ¨ä»½æ¥ä¸‹ä¾†æˆ‘å€‘ä¾†è™•ç† actions çš„éƒ¨ä»½ï¼Œåœ¨é€™å€‹ç¯„ä¾‹ä¸­ actions ç›¸å°ç°¡å–®ï¼Œä¸»è¦å°±æ˜¯æ–°å¢å’Œæ¸›å°‘å…©å€‹è¡Œç‚ºï¼Œä»¥ä¸‹ç‚º <code>src/actions/counterActions.js</code>ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createAction &#125; <span class="keyword">from</span> <span class="string">&#x27;redux-actions&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  <span class="variable constant_">INCREMENT_COUNT</span>,</span><br><span class="line">  <span class="variable constant_">DECREMENT_COUNT</span>,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;../constants/actionTypes&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> incrementCount = <span class="title function_">createAction</span>(<span class="variable constant_">INCREMENT_COUNT</span>);</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> decrementCount = <span class="title function_">createAction</span>(<span class="variable constant_">DECREMENT_COUNT</span>);</span><br></pre></td></tr></table></figure>

<p>ä»¥ä¸‹ç‚ºè¼¸å‡ºå¸¸æ•¸ <code>src/constants/actionTypes.js</code>ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="variable constant_">INCREMENT_COUNT</span> = <span class="string">&#x27;INCREMENT_COUNT&#x27;</span>;  </span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="variable constant_">DECREMENT_COUNT</span> = <span class="string">&#x27;DECREMENT_COUNT&#x27;</span>;  </span><br></pre></td></tr></table></figure>

<p>åœ¨é€™å€‹ç¯„ä¾‹ä¸­æˆ‘å€‘ä½¿ç”¨ <code>setTimeout()</code> ä¾†æ¨¡æ“¬éåŒæ­¥çš„ç”¢ç”Ÿè³‡æ–™è®“ server ç«¯åœ¨æ¯æ¬¡æ¥æ”¶ request æ™‚è®€å–éš¨æ©Ÿç”¢ç”Ÿçš„å€¼ã€‚å¯¦å‹™ä¸Šï¼Œæˆ‘å€‘æœƒé–‹ API è®“ Server è®€å–åˆå§‹è¦åŒ¯å…¥çš„ initialStateã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">getRandomInt</span>(<span class="params">min, max</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * (max - min)) + min</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">fetchCounter</span>(<span class="params">callback</span>) &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">callback</span>(<span class="title function_">getRandomInt</span>(<span class="number">1</span>, <span class="number">100</span>))</span><br><span class="line">  &#125;, <span class="number">500</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è«‡å®Œ actions æˆ‘å€‘ä¾†çœ‹æˆ‘å€‘çš„ reducersï¼Œåœ¨é€™å€‹ç¯„ä¾‹ä¸­ reducers ä¹Ÿæ˜¯ç›¸å°ç°¡å–®çš„ï¼Œä¸»è¦å°±æ˜¯é‡å°æ–°å¢å’Œæ¸›å°‘å…©å€‹è¡Œç‚ºå» set å€¼ï¼Œä»¥ä¸‹æ˜¯ <code>src/reducers/counterReducers.js</code>ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; fromJS &#125; <span class="keyword">from</span> <span class="string">&#x27;immutable&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; handleActions &#125; <span class="keyword">from</span> <span class="string">&#x27;redux-actions&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">CounterState</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;../constants/models&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  <span class="variable constant_">INCREMENT_COUNT</span>,</span><br><span class="line">  <span class="variable constant_">DECREMENT_COUNT</span>,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;../constants/actionTypes&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> counterReducers = <span class="title function_">handleActions</span>(&#123;</span><br><span class="line">  <span class="attr">INCREMENT_COUNT</span>: <span class="function">(<span class="params">state</span>) =&gt;</span> (</span><br><span class="line">    state.<span class="title function_">set</span>(</span><br><span class="line">      <span class="string">&#x27;count&#x27;</span>,</span><br><span class="line">      state.<span class="title function_">get</span>(<span class="string">&#x27;count&#x27;</span>) + <span class="number">1</span></span><br><span class="line">    )</span><br><span class="line">  ),</span><br><span class="line">  <span class="attr">DECREMENT_COUNT</span>: <span class="function">(<span class="params">state</span>) =&gt;</span> (</span><br><span class="line">    state.<span class="title function_">set</span>(</span><br><span class="line">      <span class="string">&#x27;count&#x27;</span>,</span><br><span class="line">      state.<span class="title function_">get</span>(<span class="string">&#x27;count&#x27;</span>) - <span class="number">1</span></span><br><span class="line">    )</span><br><span class="line">  ),</span><br><span class="line">&#125;, <span class="title class_">CounterState</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> counterReducers;</span><br></pre></td></tr></table></figure>

<p>æº–å‚™å¥½äº† <code>rootReducer</code> å°±å¯ä»¥ä½¿ç”¨ <code>createStore</code> ä¾†å‰µå»ºæˆ‘å€‘ storeï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ç”±æ–¼ <code>configureStore</code> éœ€è¦è¢« client-side å’Œ server-side ä½¿ç”¨ï¼Œæ‰€ä»¥æŠŠå®ƒè¼¸å‡ºæˆ function æ–¹ä¾¿å‚³å…¥ initialState ä½¿ç”¨ã€‚ä»¥ä¸‹æ˜¯ <code>src/store/configureStore.js</code>ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createStore, applyMiddleware &#125; <span class="keyword">from</span> <span class="string">&#x27;redux&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> thunk <span class="keyword">from</span> <span class="string">&#x27;redux-thunk&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> createLogger <span class="keyword">from</span> <span class="string">&#x27;redux-logger&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> rootReducer <span class="keyword">from</span> <span class="string">&#x27;../reducers&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">configureStore</span>(<span class="params">preloadedState</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> store = <span class="title function_">createStore</span>(</span><br><span class="line">    rootReducer,</span><br><span class="line">    preloadedState,</span><br><span class="line">    <span class="title function_">applyMiddleware</span>(<span class="title function_">createLogger</span>(&#123; <span class="attr">stateTransformer</span>: <span class="function"><span class="params">state</span> =&gt;</span> state.<span class="title function_">toJS</span>() &#125;), thunk)</span><br><span class="line">  )</span><br><span class="line">  <span class="keyword">return</span> store</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æœ€å¾Œä¾†åˆ°äº† <code>components</code> å’Œ <code>containers</code> çš„æ™‚é–“ï¼Œé€™æ¬¡æˆ‘å€‘çš„ Component ä¸»è¦æœ‰å…©å€‹æŒ‰éˆ•è®“ä½¿ç”¨è€…å¯ä»¥æ–°å¢å’Œæ¸›å°‘æ•¸å­—ä¸¦é¡¯ç¤ºç›®å‰æ•¸å­—ã€‚ä»¥ä¸‹æ˜¯ <code>src/components/Counter/Counter.js</code>ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span>, <span class="title class_">PropTypes</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Counter</span> = (<span class="params">&#123;</span></span><br><span class="line"><span class="params">  count,</span></span><br><span class="line"><span class="params">  onIncrement,</span></span><br><span class="line"><span class="params">  onDecrement,</span></span><br><span class="line"><span class="params">&#125;</span>) =&gt; (</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    Clicked: &#123;count&#125; times</span></span><br><span class="line"><span class="language-xml">    &#123;&#x27; &#x27;&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;onIncrement&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      +</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    &#123;&#x27; &#x27;&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;onDecrement&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      -</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    &#123;&#x27; &#x27;&#125;</span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ³¨æ„è¦æª¢æŸ¥ propTypes å’Œçµ¦å®šé è¨­å€¼</span></span><br><span class="line"><span class="title class_">Counter</span>.<span class="property">propTypes</span> = &#123;</span><br><span class="line">  <span class="attr">count</span>: <span class="title class_">PropTypes</span>.<span class="property">number</span>.<span class="property">isRequired</span>,</span><br><span class="line">  <span class="attr">onIncrement</span>: <span class="title class_">PropTypes</span>.<span class="property">func</span>.<span class="property">isRequired</span>,</span><br><span class="line">  <span class="attr">onDecrement</span>: <span class="title class_">PropTypes</span>.<span class="property">func</span>.<span class="property">isRequired</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Counter</span>.<span class="property">defaultProps</span> = &#123;</span><br><span class="line">  <span class="attr">count</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="attr">onIncrement</span>: <span class="function">() =&gt;</span> &#123;&#125;,</span><br><span class="line">  <span class="attr">onDecrement</span>: <span class="function">() =&gt;</span> &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Counter</span>;</span><br></pre></td></tr></table></figure>

<p>æœ€å¾ŒæŠŠå–å‡ºçš„ <code>count </code> å’Œäº‹ä»¶è™•ç†æ–¹æ³•ç”¨ connect å‚³åˆ° <code>Counter</code> å°±å¤§åŠŸå‘Šæˆäº†ï¼ä»¥ä¸‹æ˜¯ <code>src/containers/CounterContainer/CounterContainer.js</code>ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;babel-polyfill&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">&#x27;react-redux&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Counter</span> <span class="keyword">from</span> <span class="string">&#x27;../../components/Counter&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  incrementCount,</span><br><span class="line">  decrementCount,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;../../actions&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">connect</span>(</span><br><span class="line">  <span class="function">(<span class="params">state</span>) =&gt;</span> (&#123;</span><br><span class="line">    <span class="attr">count</span>: state.<span class="title function_">get</span>(<span class="string">&#x27;counterReducers&#x27;</span>).<span class="title function_">get</span>(<span class="string">&#x27;count&#x27;</span>),</span><br><span class="line">  &#125;),</span><br><span class="line">  <span class="function">(<span class="params">dispatch</span>) =&gt;</span> (&#123; </span><br><span class="line">    <span class="attr">onIncrement</span>: <span class="function">() =&gt;</span> (</span><br><span class="line">      <span class="title function_">dispatch</span>(<span class="title function_">incrementCount</span>())</span><br><span class="line">    ),</span><br><span class="line">    <span class="attr">onDecrement</span>: <span class="function">() =&gt;</span> (</span><br><span class="line">      <span class="title function_">dispatch</span>(<span class="title function_">decrementCount</span>())</span><br><span class="line">    ),</span><br><span class="line">  &#125;)</span><br><span class="line">)(<span class="title class_">Counter</span>);</span><br></pre></td></tr></table></figure>

<p>è‹¥ä¸€åˆ‡é †åˆ©ï¼Œåœ¨çµ‚ç«¯æ©Ÿæ‰“ä¸Š <code>$ npm start</code>ï¼Œä½ å°‡å¯ä»¥åœ¨ç€è¦½å™¨çš„ <code>http://localhost:3000</code> çœ‹åˆ°è‡ªå·±çš„æˆæœï¼</p>
<p><img src="/img/kdchang/react-server-rendering-demo.png" alt="React Redux Sever Renderingï¼ˆIsomorphicï¼‰å…¥é–€" title="React Redux Sever Renderingï¼ˆIsomorphicï¼‰å…¥é–€"></p>
<h2 id="ç¸½çµ"><a href="#ç¸½çµ" class="headerlink" title="ç¸½çµ"></a>ç¸½çµ</h2><p>æœ¬ç« é—¡è¿°äº† Web é é¢ç€è¦½çš„é€²ç¨‹å’Œ Isomorphic JavaScript çš„å„ªå‹¢ï¼Œä¸¦ä»‹ç´¹äº†å¦‚ä½•ä½¿ç”¨ React Redux é€²è¡Œ Server Side Rendering çš„æ‡‰ç”¨ç¨‹å¼è¨­è¨ˆã€‚è‹¥æƒ³åƒè€ƒæ›´é€²ä¸€æ­¥è³‡æ–™å¯ä»¥åƒè€ƒç­†è€…æ’°å¯«çš„ React å…¥é–€æ•™å­¸æ›¸ <a target="_blank" rel="noopener" href="https://github.com/kdchang/reactjs101">ã€Šå¾é›¶é–‹å§‹å­¸ ReactJSã€‹</a>ï¼Œç›¸é—œç¯„ä¾‹ç¨‹å¼ç¢¼å¯ä»¥<a target="_blank" rel="noopener" href="https://github.com/kdchang/reactjs101/tree/master/Ch10/react-redux-server-rendering">åƒè€ƒé€™è£¡</a>ï¼Œè‹¥æœ‰ä»»ä½•å•é¡Œæˆ–å»ºè­°æ­¡è¿ä¸€èµ·å­¸ç¿’è¨è«–ï¼šï¼‰</p>
<h2 id="å»¶ä¼¸é–±è®€"><a href="#å»¶ä¼¸é–±è®€" class="headerlink" title="å»¶ä¼¸é–±è®€"></a>å»¶ä¼¸é–±è®€</h2><ol>
<li><a target="_blank" rel="noopener" href="https://github.com/DavidWells/isomorphic-react-example">DavidWells&#x2F;isomorphic-react-example</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/RickWong/react-isomorphic-starterkit">RickWong&#x2F;react-isomorphic-starterkit</a></li>
<li><a target="_blank" rel="noopener" href="https://www.bensmithett.com/server-rendered-react-components-in-rails/">Server-rendered React components in Rails</a></li>
<li><a target="_blank" rel="noopener" href="http://nerds.airbnb.com/weve-launched-our-first-nodejs-app-to-product/">Our First Node.js App: Backbone on the Client and Server</a></li>
<li><a target="_blank" rel="noopener" href="https://bensmithett.github.io/going-isomorphic-with-react/#/">Going Isomorphic with React</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/airbnb/hypernova">A service for server-side rendering your JavaScript views</a></li>
<li><a target="_blank" rel="noopener" href="http://nerds.airbnb.com/isomorphic-javascript-future-web-apps/">Isomorphic JavaScript: The Future of Web Apps</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/reactjs/react-router-tutorial/tree/master/lessons/13-server-rendering">React Router Server Rendering</a></li>
</ol>
<p>ï¼ˆimage via <a target="_blank" rel="noopener" href="http://nerds.airbnb.com/wp-content/uploads/2013/11/Screen-Shot-2013-11-06-at-5.21.00-PM.png">airbnb</a>ï¼‰</p>
<p>é—œæ–¼ä½œè€…ï¼š<br><a target="_blank" rel="noopener" href="http://blog.kdchang.cc/">@kdchang</a> æ–‡è—å‹é–‹ç™¼è€…ï¼Œå¤¢æƒ³æ˜¯åšå‡ºäººå€‘æƒ³ç”¨çš„ç”¢å“å’Œè¾¦ä¸€æ‰€å¿ƒç›®ä¸­ç†æƒ³çš„å­¸æ ¡ï¼Œç›®å‰å°ˆæ³¨åœ¨ Mobile å’Œ IoT æ‡‰ç”¨é–‹ç™¼ã€‚A Starter &amp; Maker. JavaScript, Python &amp; Arduino&#x2F;Android lover.:) </p>
  
      <div>å–œæ­¡æˆ‘å€‘çš„æ–‡ç« å—ï¼Ÿæ­¡è¿åˆ†äº«æŒ‰è®šçµ¦äºˆæˆ‘å€‘æ”¯æŒå’Œé¼“å‹µï¼</div>
      <div class="fb-like" data-href="https://blog.techbridge.cc/2016/08/27/react-redux-immutablejs-node-server-isomorphic-tutorial/index.html" data-layout="button_count" data-action="like" data-size="large" data-show-faces="false" data-share="true"></div>
      <br>
      <br>
      <div class="fb-page" data-href="https://www.facebook.com/techbridge.cc" data-small-header="false" data-adapt-container-width="true" data-hide-cover="false" data-show-facepile="true"><blockquote cite="https://www.facebook.com/techbridge.cc" class="fb-xfbml-parse-ignore"><a target="_blank" rel="noopener" href="https://www.facebook.com/techbridge.cc">TechBridge æŠ€è¡“æ—¥å ±</a></blockquote></div>
      <br>
    </section>
    <br>
    <hr>
    <div>
      <h4>è¨‚é–± TechBridge Weekly æŠ€è¡“é€±åˆŠï¼Œæ¯é€±ç™¼é€æœ€ç²¾è¯çš„æŠ€è¡“é–‹ç™¼ã€ç”¢å“è¨­è¨ˆçš„è³‡è¨Šçµ¦æ‚¨</h4>
      <form class="form-control" method="post" action="https://goodbits.io/e/cab8a418-6b70-48d6-97ea-b5f0ef34b22c" target="_blank">
        <input class="form-control" type="text" name="first_name" placeholder="First Name"></input>
        <input class="form-control" type="text" name="last_name" placeholder="Last Name"></input>
        <div>
          <input class="form-control" type="text" name="email" placeholder="Email"></input>
        </div>
        <br>
        <div>
          <button class="form-control btn subscribe-btn" type="submit">é¦¬ä¸Šè¨‚é–±æŠ€è¡“é€±åˆŠ</button>
        </div>
        <br>
        <label for="">PS. æˆ‘å€‘è¨å­åƒåœ¾ä¿¡ï¼Œæ‰€ä»¥æˆ‘å€‘åªæä¾›æœ‰åƒ¹å€¼çš„å…§å®¹çµ¦æ‚¨ :)</label>
      </form>
    </div>
    <footer class="post-footer">
      <section class="author">
    <h4>TechBridge Weekly æŠ€è¡“é€±åˆŠç·¨è¼¯åœ˜éšŠ</h4>
    <p>TechBridge Weekly æŠ€è¡“é€±åˆŠåœ˜éšŠæ˜¯ä¸€ç¾¤å°ç”¨æŠ€è¡“æ”¹è®Šä¸–ç•Œæ‡·æŠ±ç†±æƒ…çš„åœ˜éšŠã€‚æœ¬æŠ€è¡“å…±ç­†éƒ¨è½æ ¼åˆæœŸå°ˆæ³¨æ–¼Webå‰å¾Œç«¯ã€è¡Œå‹•ç¶²è·¯ã€æ©Ÿå™¨äºº/ç‰©è¯ç¶²ã€è³‡æ–™ç§‘å­¸èˆ‡ç”¢å“è¨­è¨ˆç­‰æŠ€è¡“åˆ†äº«ã€‚This is TechBridge Weekly Team Tech Blog, which focus on web, mobile, robotics, IoT, Data Science technology sharing.</p>
    <span><a href="/2016/03/19/about/">é—œæ–¼æˆ‘å€‘</a></span> / <span><a href="https://www.techbridge.cc/" target="_blank">æŠ€è¡“æ—¥å ±</a></span> / <span><a href="http://weekly.techbridge.cc/" target="_blank">æŠ€è¡“é€±åˆŠ</a></span> / <span><a href="https://www.facebook.com/techbridge.cc/" target="_blank">ç²‰çµ²å°ˆé </a></span> / <span><a href="/atom.xml" target="_blank">è¨‚é–±RSS </a></span>   
	<div class="fb-like" data-href="https://www.facebook.com/techbridge.cc" data-layout="button_count" data-size="large" data-action="like" data-show-faces="false" data-share="true"></div>    
</section>
      <section class="share">
    <h4>Share this post</h4>
    <a class="icon-twitter" target="_blank" rel="noopener" href="http://twitter.com/share?url=https://blog.techbridge.cc/2016/08/27/react-redux-immutablejs-node-server-isomorphic-tutorial/"
       onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
        <span class="hidden">Twitter</span>
    </a>
    <a class="icon-facebook" target="_blank" rel="noopener" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.techbridge.cc/2016/08/27/react-redux-immutablejs-node-server-isomorphic-tutorial/"
       onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
        <span class="hidden">Facebook</span>
    </a>
    <a class="icon-google-plus" target="_blank" rel="noopener" href="https://plus.google.com/share?url=https://blog.techbridge.cc/2016/08/27/react-redux-immutablejs-node-server-isomorphic-tutorial/"
       onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
        <span class="hidden">Google+</span>
    </a>
    <iframe src="https://ghbtns.com/github-btn.html?user=TechBridgeHQ&repo=blog-starter-kit&type=star&count=true" frameborder="0" scrolling="0" width="170px" height="20px"></iframe>      
</section>
    </footer>
    <br>
  </article>
  <nav class="pagination" role="pagination">
    <h2>æ›´å¤šå„ªè³ªæŠ€è¡“æ–‡ç« </h2>
    
    <a class="newer-posts" href="/2016/09/03/how-to-control-bot-motion-by-ROSTopic/">
        â† å¦‚ä½•ç”¨ ROS Topic æ§åˆ¶æ©Ÿå™¨äººç§»å‹•
    </a>
    
    <span class="page-number">â€¢</span>
    
    <a class="older-posts" href="/2016/08/20/d3v4-pokemon-weaknesses/">
        ç”¨ D3.js v4 çœ‹ Pokemon å±¬æ€§è¡¨ â†’
    </a>
    
</nav>
  <div id="comment" class="comments-area">
    <h1 class="title"><a href="#disqus_comments" name="disqus_comments">ç•™è¨€è¨è«–</a></h1>

    
    <div id="disqus_thread">
        <noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>
    
</div>
</main>


  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-75308642-1', 'auto');
  ga('send', 'pageview');

</script>
<footer class="site-footer">
  
  <a class="subscribe icon-feed" href="/atom.xml"><span class="tooltip">Subscribe!</span></a>
  
  <div class="inner">
     <section class="copyright">All content copyright <a href="/">TechBridge æŠ€è¡“å…±ç­†éƒ¨è½æ ¼</a> &copy; 2017 &bull; All rights reserved.</section>
  </div>
</footer>

  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>

<script type="text/javascript" src="/js/jquery.fitvids.js"></script>
<script type="text/javascript" src="/js/index.js"></script>


<script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', '[object Object]']);
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
</script>


<script type="text/javascript">
    var disqus_shortname = 'techbridgeweekly';

    (function(){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.4/dist/medium-zoom.min.js"></script>
<script>
// NodeList
mediumZoom(document.querySelectorAll('img'));
</script>
  <div id="fb-root"></div>
	<script>(function(d, s, id) {
	  var js, fjs = d.getElementsByTagName(s)[0];
	  if (d.getElementById(id)) return;
	  js = d.createElement(s); js.id = id;
	  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.5";
	  fjs.parentNode.insertBefore(js, fjs);
	}(document, 'script', 'facebook-jssdk'));</script>
</body>
</html>
