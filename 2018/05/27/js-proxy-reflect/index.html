<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <title>一起來了解 Javascript 中的 Proxy 與 Reflect | TechBridge 技術共筆部落格</title>
  <meta name="description" content="TechBridge Weekly 技術週刊團隊是一群對用技術改變世界懷抱熱情的團隊。本技術共筆部落格初期專注於Web前後端、行動網路、機器人/物聯網、數據分析與產品設計等技術分享" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="MobileOptimized" content="320" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <!-- google-site-verification -->
  <meta
    name="google-site-verification"
    content="bcOr2jIfPaRI5ngBviymG6zkEU_VN3sbfABLt0hsmoc"
  />
  <link
    rel="stylesheet preload"
    type="text/css"
    href="/css/screen.css"
    as="style"
  />
  <link
    rel="stylesheet preload"
    type="text/css"
    href="//fonts.googleapis.com/css?family=Noto+Serif:400,700,400italic|Open+Sans:700,400"
    as="style"
  />

  <!-- Favicons -->
  <link rel="apple-touch-icon" href="/img/favicon.ico" />
  <link rel="icon preload" href="/img/favicon.ico" as="image" />

   
  <link
    rel="alternate"
    type="application/atom+xml"
    title="Atom 0.3"
    href="atom.xml"
  />
    
</head>


<body class="post-template">

  <header class="site-head" >
    <div class="vertical">
        <div class="site-head-content inner">
             <a class="blog-logo" href="/"><img src="/img/logo-tb-500-500.png" alt="Blog Logo"/></a> 
            <h1 class="blog-title">TechBridge 技術共筆部落格</h1>
            <h2 class="blog-description">var topics = ['Web前後端', '行動網路', '機器人/物聯網', '數據分析', '產品設計', 'etc.']</h2>
            <div class="navbar-block">
                <span><a href="/">首頁</a></span> / <span><a href="/about/">關於我們</a></span> / <span><a href="http://weekly.techbridge.cc/" target="_blank">技術週刊</a></span> / <span><a href="https://www.facebook.com/techbridge.cc/" target="_blank">粉絲專頁</a></span> / <span><a href="/atom.xml" target="_blank">訂閱RSS </a></span>
                <br>
            </div>
        </div>
    </div>
</header>
  

<main class="content" role="main">
  <article class="post">
    <span class="post-meta">
      <time datetime="2018-05-27T23:20:17.000Z" itemprop="datePublished">
          2018-05-27
      </time>
    
    
    | 
    <a href='/tags/es6/'>es6</a>,
    
    <a href='/tags/javascript/'>javascript</a>,
    
    <a href='/tags/proxy/'>proxy</a>,
    
    <a href='/tags/reflect/'>reflect</a>,
    
    <a href='/tags/frameworkless/'>frameworkless</a>
    
    
</span>

<meta name="generator" content="一起來了解 Javascript 中的 Proxy 與 Reflect">
<meta name="og:title" content="一起來了解 Javascript 中的 Proxy 與 Reflect">
<meta name="og:description" content="TechBridge Weekly 技術週刊團隊是一群對用技術改變世界懷抱熱情的團隊。本技術共筆部落格初期專注於Web前後端、行動網路、機器人/物聯網、數據分析與產品設計等技術分享。">
<meta name="og:type" content="website">
<meta name="og:image" content="/img/og-cover.png">

    <h1 class="post-title">一起來了解 Javascript 中的 Proxy 與 Reflect</h1>
    <section class="post-content">
      <div class="fb-like" data-href="https://www.facebook.com/techbridge.cc" data-layout="button_count" data-action="like" data-size="large" data-show-faces="false" data-share="true"></div>   
      <hr>
      <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>在眾多 ES6 提供的新功能上，Proxy 與 Reflect 算是最少被提及的，主要原因我想還是因為瀏覽器的支援度較低，不過在我前陣子看到 <a target="_blank" rel="noopener" href="https://jack.ofspades.com/frameworless-javascript-part-3-one-way-data-binding/">Frameworkless JavaScript Part 3: One-Way Data Binding</a> 這篇文章時（好文推薦！很有趣），特意去查了一下才發現目前支援度已經越來越好：</p>
<p><img src="/img/arvinh/caniuseproxy.png" alt="Can I Use Proxy"></p>
<p><img src="/img/arvinh/caniusereflect.png" alt="Can I Use Reflect"></p>
<p>常用的瀏覽器幾乎都支援，我想也是可以來好好了解一下這兩個神奇的物件了！</p>
<p>最後有個參考該篇文章實作的 Todo app 範例，如果懶得看介紹的可以先 <a href="#todo-sample">跳下去</a> 玩玩，但若是對 Proxy 與 Reflect 不了解的人還是建議先看一下。</p>
<h1 id="Proxy"><a href="#Proxy" class="headerlink" title="Proxy"></a>Proxy</h1><blockquote>
<p>Proxy 物件被使用於定義基本操作的自定行為（例如：尋找屬性、賦值、列舉、函式調用等等）。 - <a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Reference/Global_Objects/Proxy">MDN</a></p>
</blockquote>
<p>不知道為什麼唸起來有點饒口，但基本上跟其字面意思相同，就是代理（代為管理）物件行為。</p>
<p>Proxy 是一個函式物件（可被建構），他提供一個機會讓你能介入一般物件的基本操作行為，像是在你 assign 一個值給某個物件時，可以透過 Proxy 先進行一些 validation 等等，藉此讓使用被代理過後的物件之開發者可以專注在其他核心功能上。</p>
<p>咦？聽起來很像許多 framework 或 helper library 會做的事情？有趣！讓我們繼續看下去。</p>
<p>使用方法如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> proxyObj = <span class="keyword">new</span> <span class="title class_">Proxy</span>(target, handler);</span><br></pre></td></tr></table></figure>

<p><code>target</code> 就是你想要代理的對象；而 <code>handler</code> 則是一個物件，其中定義了所有你想替 target 代為管理的操作定義，包含了：</p>
<ul>
<li><p>construct(target, args) - 代理 Object 的 <code>new</code> operator</p>
</li>
<li><p>get(target, prop, receiver) - 代理 Object getting properties 時的行為</p>
</li>
<li><p>set(target, prop, value, receiver) - 代理 Object setting properties 時的行為</p>
</li>
<li><p>apply(target, object, args) - 代理 function call，像是 f.apply()</p>
</li>
<li><p>has(target, prop) - 代理 <code>in</code> operator</p>
</li>
<li><p>defineProperty(target, propKey, propDesc) - 代理 <code>Object.defineProperty</code>.</p>
</li>
<li><p>deleteProperty(target, prop) - 代理 <code>delete</code> operator</p>
</li>
<li><p>getOwnPropertyDescriptor(target, prop) - 代理 <code>Object.getOwnPropertyDescriptor</code>.</p>
</li>
<li><p>getPrototypeOf(target) - 代理 <code>Object.getPrototypeOf</code>.</p>
</li>
<li><p>setPrototypeOf(target, proto) - 代理 <code>Object.setPrototypeOf</code>.</p>
</li>
<li><p>ownKeys(target) - 代理 <code>Object.getOwnPropertyNames</code> 與 <code>Object.getOwnPropertySymbols</code>.</p>
</li>
<li><p>isExtensible(target) - 代理 <code>Object.isExtensible</code>.</p>
</li>
<li><p>preventExtensions(target) - 代理 <code>Object.preventExtensions</code>.</p>
</li>
</ul>
<p><code>handler</code> object 所包含的 method 定義可以從 <a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Reference/Global_Objects/Proxy">MDN</a> 看到更多範例與描述。</p>
<h2 id="說了這麼多，我們到底能拿-Proxy-來做什麼呢？直接來點範例吧！"><a href="#說了這麼多，我們到底能拿-Proxy-來做什麼呢？直接來點範例吧！" class="headerlink" title="說了這麼多，我們到底能拿 Proxy 來做什麼呢？直接來點範例吧！"></a>說了這麼多，我們到底能拿 Proxy 來做什麼呢？直接來點範例吧！</h2><h3 id="直觀的私有變數"><a href="#直觀的私有變數" class="headerlink" title="直觀的私有變數"></a>直觀的私有變數</h3><p>以往在 Javascript 中，我們可能需要透過 <code>closure</code> 來實現物件的私有變數，像是：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">FooBar</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">closeTime</span> = <span class="string">&#x27;never&#x27;</span>;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">setSecretDrink</span> = <span class="function">(<span class="params">secret</span>) =&gt;</span> &#123; secretDrink = secret; &#125;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">getSecretDrink</span> = <span class="function">() =&gt;</span> &#123; <span class="keyword">return</span> secretDrink; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> fooBar = <span class="keyword">new</span> <span class="title class_">FooBar</span>();</span><br><span class="line">fooBar.<span class="title function_">setSecretDrink</span>(<span class="string">&#x27;Jäger Bom&#x27;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(fooBar.<span class="title function_">getSecretDrink</span>()); <span class="comment">// &#x27;Jäger Bom&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(fooBar.<span class="property">closeTime</span>); <span class="comment">// never</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(fooBar.<span class="property">secretDrink</span>); <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure>

<p>但透過 Proxy，我們可以很直觀地在一個 Object 內達成類似效果：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="title class_">FooBar</span> = &#123;</span><br><span class="line">  <span class="attr">_secretDrink</span>: <span class="string">&#x27;Jäger Bom&#x27;</span>,</span><br><span class="line">  <span class="attr">closeTime</span>: <span class="string">&#x27;never&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="title class_">FooBarProxy</span> = <span class="keyword">new</span> <span class="title class_">Proxy</span>(<span class="title class_">FooBar</span>, &#123;</span><br><span class="line">  <span class="attr">get</span>: <span class="keyword">function</span>(<span class="params">target, prop</span>) &#123;</span><br><span class="line">    <span class="comment">// 以底線開頭的作為私有變數</span></span><br><span class="line">    <span class="keyword">if</span> (prop.<span class="title function_">startsWith</span>(<span class="string">&#x27;_&#x27;</span>)) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;不能存取私有變數！&#x27;</span>);</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> target[prop]; <span class="comment">// 非私有變數，那就回傳原物件的原屬性值</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">set</span>: <span class="keyword">function</span>(<span class="params">target, prop, value</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (prop.<span class="title function_">startsWith</span>(<span class="string">&#x27;_&#x27;</span>)) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;不能修改私有變數！&#x27;</span>);</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    target[prop] = value;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">has</span>: <span class="keyword">function</span>(<span class="params">target, prop</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> prop.<span class="title function_">startsWith</span>(<span class="string">&#x27;_&#x27;</span>) ? <span class="literal">false</span> : (prop <span class="keyword">in</span> target);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title class_">FooBarProxy</span>.<span class="property">_secretDrink</span>; <span class="comment">// 不能存取私有變數！</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">FooBarProxy</span>.<span class="property">closeTime</span>); <span class="comment">// never</span></span><br><span class="line"><span class="title class_">FooBarProxy</span>.<span class="property">_secretDrink</span> = <span class="string">&#x27;Cola&#x27;</span>; <span class="comment">// 不能修改私有變數！</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;_secretDrink&#x27;</span> <span class="keyword">in</span> <span class="title class_">FooBarProxy</span>); <span class="comment">// false</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;closeTime&#x27;</span> <span class="keyword">in</span> <span class="title class_">FooBarProxy</span>); <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<p>眼尖一點的讀者可能會發現，這邊 handler 裡面的 <code>get</code>、<code>set</code> 好像跟上面定義中的參數不同，少了 <code>receiver</code> 這個參數？</p>
<p>沒錯，這個神奇的第三個參數其實是指向你產生的 Proxy 實例，以上面例子來看就是 <code>FooBarProxy</code> 本身，由於範例中用不到，所以不宣告也沒關係，不過晚點在 <code>Reflect</code> 的介紹會再度提起。</p>
<p>另外，若是沒有被你代理到的操作，則會直接 fallback 回原始 target 物件的操作上。</p>
<h3 id="在設置物件屬性前進行-Validation"><a href="#在設置物件屬性前進行-Validation" class="headerlink" title="在設置物件屬性前進行 Validation"></a>在設置物件屬性前進行 Validation</h3><p>延續剛剛的例子，我們的 FooBar 除了秘密飲料外，也需要紀錄一下基本資訊，像是電話、地址等等，這時候 Proxy 就能為我們帶來另一個好處：驗證屬性值：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="title class_">FooBar</span> = &#123;</span><br><span class="line">  <span class="attr">_secretDrink</span>: <span class="string">&#x27;Jäger Bom&#x27;</span>,</span><br><span class="line">  <span class="attr">closeTime</span>: <span class="string">&#x27;never&#x27;</span>,</span><br><span class="line">  <span class="attr">phoneNumber</span>: <span class="string">&#x27;02-2849-2839&#x27;</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="title class_">FooBar</span> = <span class="keyword">new</span> <span class="title class_">Proxy</span>(<span class="title class_">FooBar</span>, &#123;</span><br><span class="line">  <span class="attr">set</span>: <span class="keyword">function</span>(<span class="params">target, prop, value</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (prop === <span class="string">&#x27;phoneNumber&#x27;</span>) &#123;</span><br><span class="line">      <span class="comment">// phone number validation</span></span><br><span class="line">      <span class="keyword">var</span> re = <span class="regexp">/^\(?\d&#123;2&#125;\)?[\s\-]?\d&#123;4&#125;\-?\d&#123;4&#125;$/</span>;</span><br><span class="line">      <span class="keyword">if</span> (!re.<span class="title function_">test</span>(value)) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="title class_">Error</span>(<span class="string">`Cannot set <span class="subst">$&#123;prop&#125;</span> to <span class="subst">$&#123;value&#125;</span>. Wrong format. Should be xx-xxxx-xxxx`</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    target[prop] = value;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">//..</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><img src="/img/arvinh/proxy-validationexample.png" alt="proxy example validation"></p>
<p>只要你設置的 <code>phoneNumber</code> 不符合 regex 的規則，就會拋出一個 Error 告訴開發者，此物件的 <code>phoneNumber</code> 屬性值是有固定 format 的。</p>
<p>當然，javascript 充滿彈性，你也可以有彈性一點的寫法，把 validator 抽離出來：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="title class_">BarValidator</span> = &#123;</span><br><span class="line">  <span class="attr">_secretDrink</span>: <span class="keyword">function</span> (<span class="params">value</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (value === <span class="string">&#x27;cola&#x27;</span>) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="title class_">Error</span>(<span class="string">&#x27;lame...&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">phoneNumber</span>: <span class="keyword">function</span>(<span class="params">value</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> re = <span class="regexp">/^\(?\d&#123;2&#125;\)?[\s\-]?\d&#123;4&#125;\-?\d&#123;4&#125;$/</span>;</span><br><span class="line">    <span class="keyword">if</span> (!re.<span class="title function_">test</span>(value)) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="title class_">Error</span>(<span class="string">`Cannot set phoneNumber to <span class="subst">$&#123;value&#125;</span>. Wrong format. Should be xx-xxxx-xxxx`</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="title class_">FooBar</span> = <span class="keyword">new</span> <span class="title class_">Proxy</span>(<span class="title class_">FooBar</span>, &#123;</span><br><span class="line">  <span class="attr">set</span>: <span class="keyword">function</span>(<span class="params">target, prop, value</span>) &#123;</span><br><span class="line">    <span class="title class_">BarValidator</span>[prop](value);</span><br><span class="line">    target[prop] = value;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">//..</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="用來設定屬性預設值"><a href="#用來設定屬性預設值" class="headerlink" title="用來設定屬性預設值"></a>用來設定屬性預設值</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 實際上沒有這個屬性</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">FooBar</span>.<span class="property">revenue</span>); <span class="comment">// undefined</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 但經過 Proxy 後</span></span><br><span class="line"><span class="title class_">FooBar</span> = <span class="keyword">new</span> <span class="title class_">Proxy</span>(<span class="title class_">FooBar</span>, &#123;</span><br><span class="line">  <span class="attr">get</span>: <span class="keyword">function</span>(<span class="params">target, prop, value</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span>(prop === <span class="string">&#x27;revenue&#x27;</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&#x27;None of your business&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> target[prop];</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">//..</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// 可以讀取到我們設定的預設值</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">FooBar</span>.<span class="property">revenue</span>); <span class="comment">// &#x27;None of your business&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="複寫原有物件，讓測試更加順利（mock-object）"><a href="#複寫原有物件，讓測試更加順利（mock-object）" class="headerlink" title="複寫原有物件，讓測試更加順利（mock object）"></a>複寫原有物件，讓測試更加順利（mock object）</h3><p>寫測試的時候很常會需要 mock object，像是 function 中若有讀取 <code>document.location.href</code> 的部分，在你開發機上基本上都會是 <code>localhost</code>，這時候就會需要把這個值 mock 掉。</p>
<p>這時我們就可以將 <code>document.location</code> 委託給 proxy 代理：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mockDocument = &#123;</span><br><span class="line">  <span class="attr">location</span>: <span class="keyword">new</span> <span class="title class_">Proxy</span>(<span class="variable language_">document</span>.<span class="property">location</span>, &#123;</span><br><span class="line">      <span class="attr">get</span>: <span class="keyword">function</span>(<span class="params">target, prop</span>) &#123;</span><br><span class="line">          <span class="keyword">if</span> (prop == <span class="string">&quot;href&quot;</span>)</span><br><span class="line">              <span class="keyword">return</span> <span class="string">&quot;your-website-com&quot;</span>;</span><br><span class="line">          <span class="keyword">return</span> target[prop];</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;location href: &quot;</span>, mockLocation.<span class="property">location</span>.<span class="property">href</span>); <span class="comment">// https://blog.arvinh.info</span></span><br></pre></td></tr></table></figure>

<h3 id="看到這邊想必很多人都會想到，我們可以實作-Observe-function！"><a href="#看到這邊想必很多人都會想到，我們可以實作-Observe-function！" class="headerlink" title="看到這邊想必很多人都會想到，我們可以實作 Observe function！"></a>看到這邊想必很多人都會想到，我們可以實作 Observe function！</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">observe</span>(<span class="params">o, callback</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Proxy</span>(o, &#123;</span><br><span class="line">    <span class="title function_">set</span>(<span class="params">target, property, value</span>) &#123;</span><br><span class="line">      <span class="title function_">callback</span>(property, value);</span><br><span class="line">      target[property] = value;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">FooBar</span> = &#123; <span class="attr">open</span>: <span class="literal">false</span> &#125;;</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">FooBarObserver</span> = <span class="title function_">observe</span>(<span class="title class_">FooBar</span>, <span class="function">(<span class="params">property, value</span>) =&gt;</span> &#123;</span><br><span class="line">  property === <span class="string">&#x27;open&#x27;</span> &amp;&amp; value ? <span class="title function_">alert</span>(<span class="string">&#x27;FooBar is open!!!&#x27;</span>) : <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;keep waiting&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="title class_">FooBarObserver</span>.<span class="property">open</span> = <span class="literal">true</span>;</span><br></pre></td></tr></table></figure>

<h3 id="不是什麼都可以被代理的"><a href="#不是什麼都可以被代理的" class="headerlink" title="不是什麼都可以被代理的"></a>不是什麼都可以被代理的</h3><p>不知道大家會不會有個疑問，難道所有物件都能被 proxy 代理嗎？有沒有辦法限制我的某個物件就是不希望被他人代理？</p>
<p>當然有！</p>
<p>如果你的物件擁有 <code>configurable: false</code> 與 <code>writable: false</code> 的屬性，那該物件就無法被 proxy 代理：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> target = <span class="title class_">Object</span>.<span class="title function_">defineProperties</span>(&#123;&#125;, &#123;</span><br><span class="line">  <span class="title class_">FooBar</span>: &#123;</span><br><span class="line">    <span class="attr">writable</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">configurable</span>: <span class="literal">false</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">const</span> handler = &#123;</span><br><span class="line">  <span class="title function_">get</span>(<span class="params">target, propKey</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;???&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> proxy = <span class="keyword">new</span> <span class="title class_">Proxy</span>(target, handler);</span><br><span class="line">proxy.<span class="property">FooBar</span></span><br><span class="line"><span class="comment">// Uncaught TypeError: &#x27;get&#x27; on proxy: property &#x27;FooBar&#x27; is a read-only and non-configurable data property on the proxy target but the proxy did not return its actual value (expected &#x27;undefined&#x27; but got &#x27;???&#x27;)</span></span><br></pre></td></tr></table></figure>

<h3 id="小結論"><a href="#小結論" class="headerlink" title="小結論"></a>小結論</h3><p>這邊我只列了幾個我覺得比較能凸顯 Proxy 用途的範例，而其他 handler 可以介入的操作如果大家也想了解並看看例子的話，阮一峰的 <a target="_blank" rel="noopener" href="http://es6.ruanyifeng.com/#docs/proxy">ECMAScript 6 入門</a> 中有針對每個操作給予例子做解析，可以參考。</p>
<h1 id="Reflect"><a href="#Reflect" class="headerlink" title="Reflect"></a>Reflect</h1><p>接著我們來看看 Reflect。Reflect 不能建構實例，就像 Math 一樣，單純包含了一系列的靜態方法。</p>
<h2 id="Reflect-與-Proxy-的完美搭配"><a href="#Reflect-與-Proxy-的完美搭配" class="headerlink" title="Reflect 與 Proxy 的完美搭配"></a>Reflect 與 Proxy 的完美搭配</h2><p>網路上許多文章都說 Reflect 是因應 Proxy 才增加的規範，最明確的連結是，Reflect 所定義的靜態方法包含了 Proxy Handler 能處理的所有代理操作，但他提供的是呼叫原始物件的操作，舉例來說：</p>
<p><code>Reflect.get(target, name);</code> 效果等同於 <code>target[name];</code></p>
<p>所以我們在 Proxy 中，如果需要 target 物件的預設操作，使用 Reflect 會更合理更清楚：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> loggedObj = <span class="keyword">new</span> <span class="title class_">Proxy</span>(obj, &#123;</span><br><span class="line">  <span class="attr">get</span>: <span class="keyword">function</span>(<span class="params">target, name</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;get&quot;</span>, target, name);</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Reflect</span>.<span class="title function_">get</span>(target, name);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="主要的理由在於，Reflect-讓我們對物件的操作可以用函數來處理"><a href="#主要的理由在於，Reflect-讓我們對物件的操作可以用函數來處理" class="headerlink" title="主要的理由在於，Reflect 讓我們對物件的操作可以用函數來處理"></a>主要的理由在於，Reflect 讓我們對物件的操作可以用函數來處理</h3><p>例如在判斷物件有無特定屬性，或是刪除物件屬性時，以往我們會這樣做：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;_secretDrink&#x27;</span> <span class="keyword">in</span> <span class="title class_">FooBar</span>;</span><br><span class="line"><span class="keyword">delete</span> <span class="title class_">Object</span>.<span class="property">_secretDrink</span>;</span><br></pre></td></tr></table></figure>

<p>有了 Reflect 我們可以這樣做：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Reflect</span>.<span class="title function_">has</span>(<span class="title class_">FooBar</span>, <span class="string">&#x27;_secretDrink&#x27;</span>);</span><br><span class="line"><span class="title class_">Reflect</span>.<span class="title function_">deleteProperty</span>(<span class="title class_">FooBar</span>, <span class="string">&#x27;_secretDrink&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>因此，在 Proxy 中，比起使用 <code>delete target[name]</code>, <code>Reflect.deleteProperty</code> 更能保持一制性：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> loggedObj = <span class="keyword">new</span> <span class="title class_">Proxy</span>(obj, &#123;</span><br><span class="line">  <span class="attr">deleteProperty</span>: <span class="keyword">function</span>(<span class="params">target, name</span>) &#123;</span><br><span class="line">    <span class="comment">// instead of `delete target[name]...</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Reflect</span>.<span class="title function_">deleteProperty</span>(target, name);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="控制被-Proxy-代理的函數之-this-參考對象"><a href="#控制被-Proxy-代理的函數之-this-參考對象" class="headerlink" title="控制被 Proxy 代理的函數之 this 參考對象"></a>控制被 Proxy 代理的函數之 this 參考對象</h3><p>這個例子比較難懂，但這是說明為何 Reflect 是因應 Proxy 而生的好例子(<a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/35276559/benefits-of-es6-reflect-api">source</a>)：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> target = &#123;</span><br><span class="line">    <span class="keyword">get</span> <span class="title function_">foo</span>() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">bar</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">bar</span>: <span class="number">3</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> handler = &#123;</span><br><span class="line">    <span class="title function_">get</span>(<span class="params">target, propertyKey, receiver</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (propertyKey === <span class="string">&#x27;bar&#x27;</span>) <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Reflect.get &#x27;</span>, <span class="title class_">Reflect</span>.<span class="title function_">get</span>(target, propertyKey, receiver)); <span class="comment">// this in foo getter references Proxy instance; logs 2</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;target[propertyKey] &#x27;</span>, target[propertyKey]); <span class="comment">// this in foo getter references &quot;target&quot; - logs 3</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> obj = <span class="keyword">new</span> <span class="title class_">Proxy</span>(target, handler);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj.<span class="property">bar</span>);</span><br><span class="line"><span class="comment">// 2</span></span><br><span class="line">obj.<span class="property">foo</span>;</span><br><span class="line"><span class="comment">// Reflect.get  2</span></span><br><span class="line"><span class="comment">// target[propertyKey]  3</span></span><br></pre></td></tr></table></figure>
<p><a class="jsbin-embed" target="_blank" rel="noopener" href="http://jsbin.com/bimadip/2/embed?js,console">JS Bin on jsbin.com</a><script src="http://static.jsbin.com/js/embed.min.js?4.1.4"></script></p>
<p>假設你的 object target 有一個 getter 函數 foo()，現在你透過 Proxy 代理 get 函數，當今天你呼叫 <code>obj.bar</code> 時，會印出 <code>2</code>，因為 Proxy handler 攔截並代理了原始 target 物件的 get 函數；接著，若你呼叫 <code>obj.foo</code>，會出現兩個結果: <code>Reflect.get  2</code> 與 <code>target[propertyKey]  3</code>。</p>
<p>為什麼？</p>
<p>這是因為只有透過 <code>Reflect.get()</code> 的第三個參數 <code>receiver</code>，將指向 Proxy 本身的實例傳進去原始物件的 get 呼叫，才能夠真的呼叫到 Proxy.get。</p>
<p>若是直接透過 <code>target[&#39;foo&#39;]</code>，則原本在 <code>foo</code> 中的 this，就會指向原始的 target 本身，而不會觸發 Proxy 的 get。</p>
<p>這邊概念真的比較難懂，若我有任何錯誤地方歡迎指正，我相信大家多看幾次範例後都能悟道的。</p>
<p>除了與 Proxy 匹配的優勢外，Reflect 還帶來了一些好處（source: <a target="_blank" rel="noopener" href="https://goo.gl/9v9STM">Benefits of ES6 Reflect API</a>, <a target="_blank" rel="noopener" href="https://github.com/tvcutsem/harmony-reflect/wiki">Harmony-reflect</a>)：</p>
<h3 id="更優雅、更好用的回傳值"><a href="#更優雅、更好用的回傳值" class="headerlink" title="更優雅、更好用的回傳值"></a>更優雅、更好用的回傳值</h3><p>以往使用 <code>Object.defineProperty(obj, name, desc);</code> 時，若成功，會回傳 obj，失敗則有可能會拋出 Error。而使用 <code>Reflect.defineProperty(obj, name, desc)</code> 的話，則會回傳 boolean 值，讓失敗或成功的結果有統一的格式。</p>
<!-- 介紹其他更多好處 https://github.com/tvcutsem/harmony-reflect/wiki-->
<h3 id="更可靠的-apply"><a href="#更可靠的-apply" class="headerlink" title="更可靠的 apply"></a>更可靠的 <code>apply</code></h3><p>在 es5 時，大家都很習慣透過 <code>f.apply(obj, args)</code> 的方式來 apply 函數到物件上頭，但很有可能在某些情況下，<code>f.apply</code> 被串改了，這時候就會有不預期的結果。</p>
<p>Senior 一點的會知道可以利用 <code>Function.prototype.apply.call(f, obj, args)</code> 來呼叫，至少 prototype 不會騙你，但這種方式總是不夠優雅。</p>
<p>現在有了 Reflect 後，就不需要擔心這種事情，透過 <code>Reflact.apply(obj, args)</code> 就能輕鬆達到一樣效果。</p>
<h3 id="接受可變參數的-Constructor"><a href="#接受可變參數的-Constructor" class="headerlink" title="接受可變參數的 Constructor"></a>接受可變參數的 Constructor</h3><p>這個優點只有跟 ES5 比較時才有優勢。主要是讓你能透過：<code>const obj = Reflect.construct(FooBar, args)</code> 來在建構物件實例時，傳遞可變參數；若是在 ES5 的世界，只有 <code>FooBar.apply</code> 或 <code>FooBar.call</code> 能夠接受變動參數，但是在 <code>new</code> 物件實例時，並沒有 <code>apply</code> 或 <code>call</code> 可以使用。</p>
<p>而現在透過 ES6 的 spread syntax，我們可以在建構物件實例時，直接傳遞可變參數：<code>const obj = new FooBar(...args)</code>。</p>
<!-- 最後說明 https://jack.ofspades.com/frameworkless-javascript-part-3-one-way-data-binding/ 中 data binding 的實作-->
<p><span id="todo-sample"></span></p>
<h2 id="最終範例：利用-Proxy-與-Reflect-完成-one-way-data-binding"><a href="#最終範例：利用-Proxy-與-Reflect-完成-one-way-data-binding" class="headerlink" title="最終範例：利用 Proxy 與 Reflect 完成 one way data binding"></a>最終範例：利用 Proxy 與 Reflect 完成 one way data binding</h2><p>在了解完 Proxy 與 Reflect 的基本使用方式後，想分享一個很有趣的應用，也就是我開頭提到，激發我研究 Proxy 的範例：frameworkless js one way data binding.</p>
<p>結合先前提過的 Observe function，來實作一個簡單 Todo App：</p>
<p data-height="339" data-theme-id="dark" data-slug-hash="LrpOEw" data-default-tab="js,result" data-user="arvin0731" data-embed-version="2" data-pen-title="Oneway-data-binding-js-proxy-reflect" class="codepen">See the Pen <a target="_blank" rel="noopener" href="https://codepen.io/arvin0731/pen/LrpOEw/">Oneway-data-binding-js-proxy-reflect</a> by Arvin (<a target="_blank" rel="noopener" href="https://codepen.io/arvin0731">@arvin0731</a>) on <a target="_blank" rel="noopener" href="https://codepen.io">CodePen</a>.</p>
<script async src="https://static.codepen.io/assets/embed/ei.js"></script>

<p>基本上是結合了上述介紹的 Proxy 與 Reflect 特性，並融合<a href="(https://jack.ofspades.com/frameworkless-javascript-part-3-one-way-data-binding/">這篇文章</a>的範例所製作的，如果大家有看完前面的介紹，對於這段 code 應該不難理解。</p>
<p>主要是透過 Proxy 來代理 Object 的 <code>set</code> 與 <code>deleteProperty</code> 操作，讓 Todo list 的變動能夠被代理。</p>
<p>此外，在先前的介紹中，都是以 Object 為主，但 todo app 範例中被 Proxy 代理的是 Array。</p>
<p>最大的差別在於，當你 push 一個新 item 進入 Array 時，<code>set</code> 會被呼叫兩次，一次是新的 item 被塞入陣列時，一次是 Array 的 <code>length</code> property 加一時。所以要特別濾掉 <code>length</code> 更動的那次代理操作。</p>
<p>最後，只要在代理的操作中，想辦法把 DOM 做對應的修改，如同上面程式中的 <code>line 22 ~ line 40</code>，定義一些 render template 的 function 來更新 DOM 即可。</p>
<!-- 最終結論 -->

<h1 id="結論"><a href="#結論" class="headerlink" title="結論"></a>結論</h1><p>Javascript 的變動總是快於瀏覽器支援度，所以常常造成一些新的 Spec 我們不熟悉、不知如何運用，這次的研究學習了不少，而上面的 Todo App 是個簡陋不嚴謹的範例，不過也足以展現 Proxy 與 Reflect 在實際運用上的情境，並帶給我們另一種思考方向，很多時候不用一開始就套用 Framework，透過越來越進步的瀏覽器與 ES 版本，我們也能達到一樣目的。雖然比不上 framework 包山包海的優化，但或許能讓我們更了解實際要解決的問題是什麼，以及解決方法背後的概念。</p>
<!-- 資料來源 -->

<h2 id="資料來源"><a href="#資料來源" class="headerlink" title="資料來源"></a>資料來源</h2><ol>
<li><a target="_blank" rel="noopener" href="https://jack.ofspades.com/frameworkless-javascript-part-3-one-way-data-binding/">Frameworkless JavaScript Part 3: One-Way Data Binding</a></li>
<li><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Reference/Global_Objects/Proxy">MDN Proxy</a></li>
<li><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/34f0e6abe312">ES6 之 Proxy 介绍</a></li>
<li><a target="_blank" rel="noopener" href="http://es6.ruanyifeng.com/#docs/proxy">ECMAScript 6 入门</a></li>
</ol>
<p>關於作者：<br><a target="_blank" rel="noopener" href="http://blog.arvinh.info/about/">@arvinh</a> 前端攻城獅，熱愛數據分析和資訊視覺化</p>
  
      <div>喜歡我們的文章嗎？歡迎分享按讚給予我們支持和鼓勵！</div>
      <div class="fb-like" data-href="https://blog.techbridge.cc/2018/05/27/js-proxy-reflect/index.html" data-layout="button_count" data-action="like" data-size="large" data-show-faces="false" data-share="true"></div>
      <br>
      <br>
      <div class="fb-page" data-href="https://www.facebook.com/techbridge.cc" data-small-header="false" data-adapt-container-width="true" data-hide-cover="false" data-show-facepile="true"><blockquote cite="https://www.facebook.com/techbridge.cc" class="fb-xfbml-parse-ignore"><a target="_blank" rel="noopener" href="https://www.facebook.com/techbridge.cc">TechBridge 技術日報</a></blockquote></div>
      <br>
    </section>
    <br>
    <hr>
    <div>
      <h4>訂閱 TechBridge Weekly 技術週刊，每週發送最精華的技術開發、產品設計的資訊給您</h4>
      <form class="form-control" method="post" action="https://goodbits.io/e/cab8a418-6b70-48d6-97ea-b5f0ef34b22c" target="_blank">
        <input class="form-control" type="text" name="first_name" placeholder="First Name"></input>
        <input class="form-control" type="text" name="last_name" placeholder="Last Name"></input>
        <div>
          <input class="form-control" type="text" name="email" placeholder="Email"></input>
        </div>
        <br>
        <div>
          <button class="form-control btn subscribe-btn" type="submit">馬上訂閱技術週刊</button>
        </div>
        <br>
        <label for="">PS. 我們討厭垃圾信，所以我們只提供有價值的內容給您 :)</label>
      </form>
    </div>
    <footer class="post-footer">
      <section class="author">
    <h4>TechBridge Weekly 技術週刊編輯團隊</h4>
    <p>TechBridge Weekly 技術週刊團隊是一群對用技術改變世界懷抱熱情的團隊。本技術共筆部落格初期專注於Web前後端、行動網路、機器人/物聯網、資料科學與產品設計等技術分享。This is TechBridge Weekly Team Tech Blog, which focus on web, mobile, robotics, IoT, Data Science technology sharing.</p>
    <span><a href="/2016/03/19/about/">關於我們</a></span> / <span><a href="https://www.techbridge.cc/" target="_blank">技術日報</a></span> / <span><a href="http://weekly.techbridge.cc/" target="_blank">技術週刊</a></span> / <span><a href="https://www.facebook.com/techbridge.cc/" target="_blank">粉絲專頁</a></span> / <span><a href="/atom.xml" target="_blank">訂閱RSS </a></span>   
	<div class="fb-like" data-href="https://www.facebook.com/techbridge.cc" data-layout="button_count" data-size="large" data-action="like" data-show-faces="false" data-share="true"></div>    
</section>
      <section class="share">
    <h4>Share this post</h4>
    <a class="icon-twitter" target="_blank" rel="noopener" href="http://twitter.com/share?url=https://blog.techbridge.cc/2018/05/27/js-proxy-reflect/"
       onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
        <span class="hidden">Twitter</span>
    </a>
    <a class="icon-facebook" target="_blank" rel="noopener" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.techbridge.cc/2018/05/27/js-proxy-reflect/"
       onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
        <span class="hidden">Facebook</span>
    </a>
    <a class="icon-google-plus" target="_blank" rel="noopener" href="https://plus.google.com/share?url=https://blog.techbridge.cc/2018/05/27/js-proxy-reflect/"
       onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
        <span class="hidden">Google+</span>
    </a>
    <iframe src="https://ghbtns.com/github-btn.html?user=TechBridgeHQ&repo=blog-starter-kit&type=star&count=true" frameborder="0" scrolling="0" width="170px" height="20px"></iframe>      
</section>
    </footer>
    <br>
  </article>
  <nav class="pagination" role="pagination">
    <h2>更多優質技術文章</h2>
    
    <a class="newer-posts" href="/2018/06/09/intro-to-CRAM/">
        ← 一起來讀 CRAM - A Cognitive Robot Abstract Machine for Everyday Manipulation in Human Environments
    </a>
    
    <span class="page-number">•</span>
    
    <a class="older-posts" href="/2018/05/24/ngrok/">
        測試 webhook 不再煩惱：ngrok →
    </a>
    
</nav>
  <div id="comment" class="comments-area">
    <h1 class="title"><a href="#disqus_comments" name="disqus_comments">留言討論</a></h1>

    
    <div id="disqus_thread">
        <noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>
    
</div>
</main>


  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-75308642-1', 'auto');
  ga('send', 'pageview');

</script>
<footer class="site-footer">
  
  <a class="subscribe icon-feed" href="/atom.xml"><span class="tooltip">Subscribe!</span></a>
  
  <div class="inner">
     <section class="copyright">All content copyright <a href="/">TechBridge 技術共筆部落格</a> &copy; 2017 &bull; All rights reserved.</section>
  </div>
</footer>

  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>

<script type="text/javascript" src="/js/jquery.fitvids.js"></script>
<script type="text/javascript" src="/js/index.js"></script>


<script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', '[object Object]']);
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
</script>


<script type="text/javascript">
    var disqus_shortname = 'techbridgeweekly';

    (function(){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.4/dist/medium-zoom.min.js"></script>
<script>
// NodeList
mediumZoom(document.querySelectorAll('img'));
</script>
  <div id="fb-root"></div>
	<script>(function(d, s, id) {
	  var js, fjs = d.getElementsByTagName(s)[0];
	  if (d.getElementById(id)) return;
	  js = d.createElement(s); js.id = id;
	  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.5";
	  fjs.parentNode.insertBefore(js, fjs);
	}(document, 'script', 'facebook-jssdk'));</script>
</body>
</html>
