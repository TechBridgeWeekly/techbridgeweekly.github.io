<!DOCTYPE html>
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" >
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
  <title>CSS 魔術師 Houdini API 介紹 | TechBridge 技術共筆部落格</title>
  <meta name="description" content="TechBridge Weekly 技術週刊團隊是一群對用技術改變世界懷抱熱情的團隊。本技術共筆部落格初期專注於Web前後端、行動網路、機器人/物聯網、數據分析與產品設計等技術分享" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="MobileOptimized" content="320" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <!-- google-site-verification -->
  <meta name="google-site-verification" content="WX_9sZlrIYOEpy8RR7zCoa7-pJk611zZt11BSBUcDVY" />
  <link rel="stylesheet preload" type="text/css" href="/css/screen.css" as="style" />
  <link rel="stylesheet preload" type="text/css" href="//fonts.googleapis.com/css?family=Noto+Serif:400,700,400italic|Open+Sans:700,400" as="style" />

  <!-- Favicons -->
  <link rel="apple-touch-icon" href="/img/favicon.ico">
  <link rel="icon preload" href="/img/favicon.ico" as="image">

  
  
  <link rel="alternate" type="application/atom+xml" title="Atom 0.3" href="atom.xml">
  
  

  
</head>


<body class="post-template">

  <header class="site-head" >
    <div class="vertical">
        <div class="site-head-content inner">
             <a class="blog-logo" href="/"><img src="/img/logo-tb-500-500.png" alt="Blog Logo"/></a> 
            <h1 class="blog-title">TechBridge 技術共筆部落格</h1>
            <h2 class="blog-description">var topics = ['Web前後端', '行動網路', '機器人/物聯網', '數據分析', '產品設計', 'etc.']</h2>
            <div class="navbar-block">
                <span><a href="/">首頁</a></span> / <span><a href="/about/">關於我們</a></span> / <span><a href="http://weekly.techbridge.cc/" target="_blank">技術週刊</a></span> / <span><a href="https://www.facebook.com/techbridge.cc/" target="_blank">粉絲專頁</a></span> / <span><a href="/atom.xml" target="_blank">訂閱RSS </a></span>
                <br>
            </div>
        </div>
    </div>
</header>
  

<main class="content" role="main">
  <article class="post">
    <span class="post-meta">
      <time datetime="2017-05-23T19:44:02.000Z" itemprop="datePublished">
          2017-05-23
      </time>
    
    
    | 
    <a href='/tags/CSS/'>CSS</a>,
    
    <a href='/tags/Houdini/'>Houdini</a>,
    
    <a href='/tags/Custom-Properties/'>Custom-Properties</a>,
    
    <a href='/tags/Worklets/'>Worklets</a>
    
    
</span>

<meta name="generator" content="CSS 魔術師 Houdini API 介紹">
<meta name="og:title" content="CSS 魔術師 Houdini API 介紹">
<meta name="og:description" content="TechBridge Weekly 技術週刊團隊是一群對用技術改變世界懷抱熱情的團隊。本技術共筆部落格初期專注於Web前後端、行動網路、機器人/物聯網、數據分析與產品設計等技術分享。">
<meta name="og:type" content="website">
<meta name="og:image" content="/img/og-cover.png">

    <h1 class="post-title">CSS 魔術師 Houdini API 介紹</h1>
    <section class="post-content">
      <div class="fb-like" data-href="https://www.facebook.com/techbridge.cc" data-layout="button_count" data-action="like" data-size="large" data-show-faces="false" data-share="true"></div>   
      <hr>
      <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>今天想繼續 CSS 的議題，常常會覺得學 CSS 的新發展不太划算，因為每次看到新的 Feature 出現，都只能當下興奮個幾分鐘，然後就會認命接受可能還要再等個五年才能真正使用的可能性…如果你有跟我一樣的感受，那今天這篇文章或許可以帶給你一絲絲希望。</p>
<p>在現今的 Web 開發中，JavaScript 幾乎佔據所有版面，除了控制頁面邏輯與操作 DOM 物件以外，連 CSS 都直接寫在 JavaScript 裡面了，就算瀏覽器都還沒有實作的規格，總會有人做出對應的 Polyfills，讓你快速的將新 Feature 應用到 Production 環境中，更別提我們還有 Babel 等工具幫忙轉譯。</p>
<p>而 CSS 就不同了，除了制定 CSS 標準規格所需的時間外，各家瀏覽器的版本、實作進度差異更是曠日費時，再加上 CSS 並非 Javascript 這樣的動態語言，我們無法簡單的提供 Polyfills，頂多利用 PostCSS、SASS 等工具來幫我們轉譯出瀏覽器能接受的 CSS，而剩下的就是瀏覽器的事了。</p>
<p>這邊讓我們回想一下，瀏覽器在網頁的渲染過程中，做了哪些事情？</p>
<p><img src="/img/arvinh/render_pipeline.png" alt="Render Pipeline (source from google)"><br><em>source from google</em></p>
<p>瀏覽器的 Render Pipeline 中，<strong>JavaScript</strong> 與 <strong>Style</strong> 兩個階段會解析 HTML 並為載入的 JS 與 CSS 建立 Render Tree，也就是所謂的 DOM 與 CSSOM：（對於 Render Pipeline 與 Render Tree 若不了解，可以先看看我先前的文章 <a target="_blank" rel="noopener" href="https://blog.arvinh.info/2016/03/26/Front-end%20kata%2060fps%E7%9A%84%E5%BF%AB%E6%84%9F/">Front-end kata 60fps的快感</a>）</p>
<p><img src="/img/arvinh/RenderTree.png" alt="Render Tree (source from google)"><br><em>source from google</em></p>
<p>而就現階段的 Web 技術來看，開發者們能操作的就是透過 JS 去控制 DOM 與 CSSOM，來影響畫面的變化，但是對於接下來的 <strong>Layout</strong>、<strong>Paint</strong> 與 <strong>Composite</strong> 就幾乎沒有控制權了。</p>
<p>既無法讓各家瀏覽器快速並統一實作規格，亦不能輕易產生 Polyfills，所以到現在我們依然無法大膽使用 Flexbox，即便它早在 2009 年就被提出了…</p>
<p>但 CSS 並非就此駐足不前。</p>
<p>為了解決上述問題，為了讓 CSS 的魔力不再被瀏覽器把持，Houdini 就誕生了！（ Houdini 是美國的偉大魔術師，擅長逃脫術，很適合想將 CSS 從瀏覽器中解放的概念）</p>
<h1 id="CSS-Houdini"><a href="#CSS-Houdini" class="headerlink" title="CSS Houdini"></a>CSS Houdini</h1><p>CSS Houdini 是由一群來自 Mozilla, Apple, Opera, Microsoft, HP, Intel, IBM, Adobe 與 Google 的工程師所組成的工作小組，志在建立一系列的 API，讓開發者能夠介入瀏覽器的 CSS engine 運作，帶給開發者更多的解決方案，用來解決 CSS 長久以來的問題：</p>
<ul>
<li>Cross-Browser isse</li>
<li>CSS Polyfill 的製作困難</li>
</ul>
<p>Houdini task force 目前起草了一些 API 規範，並逐步努力讓其通過 W3C，成為真正的 Web standards。<br>由於都是草稿階段，有些甚至只有規劃，還未被真正寫入規範，所以變動很大，有些我也不是很了解，所以就大致介紹一下，若有錯誤拜託務必告知！<br>另外，有興趣的讀者可以直接從這裡 <a target="_blank" rel="noopener" href="http://dev.w3.org/houdini/">CSS Houdini Drafts</a> 看詳細內容（ Drafts 的更新時間都非常近期，活躍中的草稿！）。</p>
<p>下面這張圖我將 Google 提供的 Render pipeline 與 <a target="_blank" rel="noopener" href="https://www.smashingmagazine.com/2016/03/houdini-maybe-the-most-exciting-development-in-css-youve-never-heard-of/">Houdini: Maybe The Most Exciting Development In CSS You’ve Never Heard Of</a> 中提到的 pipeline 做個結合對比，顯示出 Houdini 試圖在瀏覽器的 Render pipeline 中提供哪些 API 給開發者使用：</p>
<p><img src="/img/arvinh/huodini-apis.png" alt="Houdini API on render pipeline"></p>
<p>其中灰色部分就是只在規劃階段，而黃色部份就是已經寫入規範正在推行中。</p>
<h1 id="Houdini-API-介紹"><a href="#Houdini-API-介紹" class="headerlink" title="Houdini API 介紹"></a>Houdini API 介紹</h1><h2 id="CSS-Properties-and-Values-API"><a href="#CSS-Properties-and-Values-API" class="headerlink" title="CSS Properties and Values API"></a>CSS Properties and Values API</h2><p>先介紹一個最能夠使用的 API，除了 IE family 以外，Chrome、Firefox 與 Safari 都已經能夠直接使用了！ <a target="_blank" rel="noopener" href="http://caniuse.com/#search=custom%20properties">caniuse</a></p>
<p>相信很多人都使用過 CSS Preprocessors，他給予開發者在 CSS 中使用變數的能力：</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$font-size</span>: <span class="number">10px</span>;</span><br><span class="line"><span class="variable">$brightBlue</span>: blue;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.mark</span>&#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">1.5</span> * <span class="variable">$font-size</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="variable">$brightBlue</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>但其實使用 Preprocessors 還是有其缺點，像是不同的 Preprocessors 就有不同的 Syntax，需要額外 setup 與 compile，<br>而現在 CSS 已經有原生的變數可以使用了！就是 CSS Properties and Values API！</p>
<p>SCSS 與 Native CSS Custom Properties 的一個主要差別可以看<a target="_blank" rel="noopener" href="http://slides.com/malyw/houdini-codemotion#/18">下圖</a>：</p>
<p><img src="/img/arvinh/scss-vs-css.png" alt="source from http://slides.com/malyw/houdini-codemotion#/18"></p>
<p>原生的 CSS variable syntax：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* declaration */</span></span><br><span class="line"><span class="attr">--VAR_NAME</span>: &lt;declaration-value&gt;;</span><br><span class="line"><span class="comment">/* usage */</span></span><br><span class="line"><span class="selector-tag">var</span>(<span class="attr">--VAR_NAME</span>)</span><br></pre></td></tr></table></figure>

<p>變數可以定義在 root element selector 內，也能在一般 selector 內，甚至是給別的變數 reuse：</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* root element selector (全域) */</span></span><br><span class="line"><span class="selector-pseudo">:root</span> &#123;</span><br><span class="line">  <span class="attr">--main-color</span>: <span class="number">#ff00ff</span>;</span><br><span class="line">  <span class="attr">--main-bg</span>: <span class="built_in">rgb</span>(<span class="number">200</span>, <span class="number">255</span>, <span class="number">255</span>);</span><br><span class="line">  <span class="attr">--block-font-size</span>: <span class="number">1rem</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.btn__active</span><span class="selector-pseudo">::after</span>&#123;</span><br><span class="line">  <span class="attr">--btn-text</span>: <span class="string">&#x27;This is btn&#x27;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* 相等於 --box-highlight-text:&#x27;This is btn been actived&#x27;; */</span></span><br><span class="line">  <span class="attr">--btn-highlight-text</span>: <span class="built_in">var</span>(--btn-text)<span class="string">&#x27; been actived&#x27;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">content</span>: <span class="built_in">var</span>(--btn-highlight-text);</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* 也能使用 calc 來做運算 */</span></span><br><span class="line">  <span class="attribute">font-size</span>: <span class="built_in">calc</span>(<span class="built_in">var</span>(--block-font-size)*<span class="number">1.5</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="comment">/* variable usage */</span></span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">var</span>(--main-color);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>而有了變數以後，會為 CSS 帶來什麼好處應該很明顯，他的 Use case 可以多寫一篇文章來介紹了，<a target="_blank" rel="noopener" href="https://blog.hospodarets.com/css_properties_in_depth">或是可以直接看這篇的詳細介紹</a>，我這邊介紹幾個我覺得比較有趣的：</p>
<ol>
<li><p>模擬一個特殊的 CSS rule:</p>
<p> 單純透過更改變數來達到改變 box-shadow 顏色</p>
 <figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.textBox</span> &#123;</span><br><span class="line"><span class="attr">--box-shadow-color</span>: yellow;</span><br><span class="line"><span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">30px</span> <span class="built_in">var</span>(--box-shadow-color);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.textBox</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line"><span class="comment">/* box-shadow: 0 0 30px green; */</span></span><br><span class="line"><span class="attr">--box-shadow-color</span>: green;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>動態調整某個 CSS rule 內的各別屬性：</p>
 <p data-height="300" data-theme-id="29194" data-slug-hash="ZKKyer" data-default-tab="html,result" data-user="malyw" data-embed-version="2" data-pen-title="Generated colors from CSS custom properties" class="codepen">See the Pen <a target="_blank" rel="noopener" href="https://codepen.io/malyw/pen/ZKKyer/">Generated colors from CSS custom properties</a> by Serg Hospodarets (<a target="_blank" rel="noopener" href="https://codepen.io/malyw">@malyw</a>) on <a target="_blank" rel="noopener" href="https://codepen.io">CodePen</a>.</p>
 <script async src="https://production-assets.codepen.io/assets/embed/ei.js"></script></li>
</ol>
<p>此外，我們也可以用 JavaScript 來控制：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> textBox = </span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.textBox&#x27;</span>);</span><br><span class="line"><span class="comment">// GET</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Bxshc</span> = <span class="title function_">getComputedStyle</span>(textBox)</span><br><span class="line">    .<span class="title function_">getPropertyValue</span>(<span class="string">&#x27;--box-shadow-color&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// SET</span></span><br><span class="line">textBox.<span class="property">style</span></span><br><span class="line">    .<span class="title function_">setProperty</span>(<span class="string">&#x27;--box-shadow-color&#x27;</span>, <span class="string">&#x27;new color&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>非常好用的特性，幾乎所有主流瀏覽器都已經支援了，大家快來使用吧！</p>
<h2 id="Box-Tree-API"><a href="#Box-Tree-API" class="headerlink" title="Box Tree API"></a>Box Tree API</h2><p>Box tree API 並沒有出現在上圖中，但在 Paintin API 中會用到其概念。<br>大家都知道在 DOM tree 中的每個元素都有一個 Box Modal，而在瀏覽器解析過程中，還會將其拆分成 fragments，至於什麼是 fragments？以 drafts 中的例子來解釋：</p>
<p data-height="300" data-theme-id="29194" data-slug-hash="wdZvOm" data-default-tab="css,result" data-user="arvin0731" data-embed-version="2" data-pen-title="fragments-sample" class="codepen">See the Pen <a target="_blank" rel="noopener" href="https://codepen.io/arvin0731/pen/wdZvOm/">fragments-sample</a> by Arvin (<a target="_blank" rel="noopener" href="https://codepen.io/arvin0731">@arvin0731</a>) on <a target="_blank" rel="noopener" href="https://codepen.io">CodePen</a>.</p>
<script async src="https://production-assets.codepen.io/assets/embed/ei.js"></script>

<p>上面的 HTML 總共就會拆出七個 fragments：</p>
<ul>
<li>最外層的 div</li>
<li>第一行的 box (包含 foo bar)</li>
<li>第二行的 box (包含 baz)</li>
<li>吃到 <code>::first-line</code> 與 <code>::first-letter</code> 的 f 也會被拆出來成獨立的 fragments</li>
<li>只吃到 <code>::first-line</code> 的 oo 只好也獨立出來</li>
<li>吃到 <code>::first-line</code> 與 包在 <code>&lt;i&gt;</code> 內的 bar 當然也是</li>
<li>在第二行底下且為 italic 的 <code>baz</code></li>
</ul>
<p>而 Box tree API 目的就是希望讓開發者能夠取得這些 fragments 的資訊，至於取得後要如何使用，基本上應該會跟後面會介紹的 Parser API、Layout API 與 Paint API 有關聯，當我們能取得詳細的 Box Modal 資訊時，要客製化 Layout Module 才更為方便。</p>
<h2 id="CSS-Layout-API"><a href="#CSS-Layout-API" class="headerlink" title="CSS Layout API"></a>CSS Layout API</h2><p>Layout API 顧名思義就是提供開發者撰寫自己的 Layout module，Layout module 也就是用來 assign 給 <code>display</code> 屬性的值，像是 <code>display: grid</code> 或 <code>display: flex</code>。<br>你只要透過 <code>registerLayout</code> 的 function，傳入 Layout 名稱與 JS class 來定義 Layout 的邏輯即可，例如我們實作一個 <code>block-like</code> 的 Layout：</p>
<figure class="highlight js"><figcaption><span>blockLike.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">registerLayout</span>(<span class="string">&#x27;block-like&#x27;</span>, <span class="keyword">class</span> <span class="title class_">extends</span> <span class="title class_">Layout</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> blockifyChildren = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">static</span> inputProperties = <span class="variable language_">super</span>.<span class="property">inputProperties</span>;</span><br><span class="line"></span><br><span class="line">    *<span class="title function_">layout</span>(<span class="params">space, children, styleMap</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> inlineSize = <span class="title function_">resolveInlineSize</span>(space, styleMap);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> bordersAndPadding = <span class="title function_">resolveBordersAndPadding</span>(constraintSpace, styleMap);</span><br><span class="line">        <span class="keyword">const</span> scrollbarSize = <span class="title function_">resolveScrollbarSize</span>(constraintSpace, styleMap);</span><br><span class="line">        <span class="keyword">const</span> availableInlineSize = inlineSize -</span><br><span class="line">                                    bordersAndPadding.<span class="property">inlineStart</span> -</span><br><span class="line">                                    bordersAndPadding.<span class="property">inlineEnd</span> -</span><br><span class="line">                                    scrollbarSize.<span class="property">inline</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> availableBlockSize = <span class="title function_">resolveBlockSize</span>(constraintSpace, styleMap) -</span><br><span class="line">                                   bordersAndPadding.<span class="property">blockStart</span> -</span><br><span class="line">                                   bordersAndPadding.<span class="property">blockEnd</span> -</span><br><span class="line">                                   scrollbarSize.<span class="property">block</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> childFragments = [];</span><br><span class="line">        <span class="keyword">const</span> childConstraintSpace = <span class="keyword">new</span> <span class="title class_">ConstraintSpace</span>(&#123;</span><br><span class="line">            <span class="attr">inlineSize</span>: availableInlineSize,</span><br><span class="line">            <span class="attr">blockSize</span>: availableBlockSize,</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> maxChildInlineSize = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">let</span> blockOffset = bordersAndPadding.<span class="property">blockStart</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> child <span class="keyword">of</span> children) &#123;</span><br><span class="line">            <span class="keyword">const</span> fragment = <span class="keyword">yield</span> child.<span class="title function_">layoutNextFragment</span>(childConstraintSpace);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 這段控制 Layout 下的 children 要 inline 排列</span></span><br><span class="line">            <span class="comment">// fragment 應該就是前述的 Box Tree API 內提到的 fragment</span></span><br><span class="line">            fragment.<span class="property">blockOffset</span> = blockOffset;</span><br><span class="line">            fragment.<span class="property">inlineOffset</span> = <span class="title class_">Math</span>.<span class="title function_">max</span>(</span><br><span class="line">                bordersAndPadding.<span class="property">inlineStart</span>,</span><br><span class="line">                (availableInlineSize - fragment.<span class="property">inlineSize</span>) / <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">            maxChildInlineSize =</span><br><span class="line">                <span class="title class_">Math</span>.<span class="title function_">max</span>(maxChildInlineSize, childFragments.<span class="property">inlineSize</span>);</span><br><span class="line">            blockOffset += fragment.<span class="property">blockSize</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> inlineOverflowSize = maxChildInlineSize + bordersAndPadding.<span class="property">inlineEnd</span>;</span><br><span class="line">        <span class="keyword">const</span> blockOverflowSize = blockOffset + bordersAndPadding.<span class="property">blockEnd</span>;</span><br><span class="line">        <span class="keyword">const</span> blockSize = <span class="title function_">resolveBlockSize</span>(</span><br><span class="line">            constraintSpace, styleMap, blockOverflowSize);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="attr">inlineSize</span>: inlineSize,</span><br><span class="line">            <span class="attr">blockSize</span>: blockSize,</span><br><span class="line">            <span class="attr">inlineOverflowSize</span>: inlineOverflowSize,</span><br><span class="line">            <span class="attr">blockOverflowSize</span>: blockOverflowSize,</span><br><span class="line">            <span class="attr">childFragments</span>: childFragments,</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>上面這段 code 是來自 <a target="_blank" rel="noopener" href="https://drafts.css-houdini.org/css-layout-api/">houdini draft 的範例</a>，完整放上來是想給大家看一下實作一個 Layout 需要注意的細節有多少，其實並不是如想像中的輕鬆，<br>相信未來會出現更多方便的 API 輔助開發。（放心接下來不會再有這麼多 code 了 XD）</p>
<p>有了 Layout API，不管是自己實作或是拿別人寫好的 Layout，你都可以直接如下方式使用：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.wrapper</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: <span class="built_in">layout</span>(<span class="string">&#x27;block-like&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="CSS-Painting-API"><a href="#CSS-Painting-API" class="headerlink" title="CSS Painting API"></a>CSS Painting API</h2><p>Painting API 與 Layout 類似，提供一個叫做 <code>registerPaint</code> 的方法：</p>
<p>定義 Paint Method，這邊偷偷用到了待會要介紹的 CSS Properties：</p>
<figure class="highlight js"><figcaption><span>simpleRect.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">registerPaint</span>(<span class="string">&#x27;simpleRect&#x27;</span>, <span class="keyword">class</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">get</span> <span class="title function_">inputProperties</span>() &#123; <span class="keyword">return</span> [<span class="string">&#x27;--rect-color&#x27;</span>]; &#125;</span><br><span class="line">    <span class="title function_">paint</span>(<span class="params">ctx, size, properties</span>) &#123;</span><br><span class="line">        <span class="comment">// 依據 properties 改變顏色</span></span><br><span class="line">        <span class="keyword">const</span> color = properties.<span class="title function_">get</span>(<span class="string">&#x27;--rect-color&#x27;</span>);</span><br><span class="line">        ctx.<span class="property">fillStyle</span> = color.<span class="property">cssText</span>;</span><br><span class="line">        ctx.<span class="title function_">fillRect</span>(<span class="number">0</span>, <span class="number">0</span>, size.<span class="property">width</span>, size.<span class="property">height</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>宣告使用：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.div-1</span> &#123;</span><br><span class="line">    <span class="attr">--rect-color</span>: red;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">50px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">50px</span>;</span><br><span class="line">    <span class="attribute">background-image</span>: <span class="built_in">paint</span>(simpleRect);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.div-2</span> &#123;</span><br><span class="line">    <span class="attr">--rect-color</span>: yellow;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">background-size</span>: <span class="number">50%</span> <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">background-image</span>: <span class="built_in">paint</span>(simpleRect);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>.div-1</code> 與 <code>.div-2</code> 就可以擁有各自定義寬高顏色的方形 background-image</p>
<h2 id="Worklets"><a href="#Worklets" class="headerlink" title="Worklets"></a>Worklets</h2><p>在上述的 Layout API 與 Paint API 中，我們都有撰寫一支 js 檔案，用來定義新的屬性，然後在 css 檔案中呼叫取用，你可能會覺得那支 js 檔案就直接像一般 web 嵌入 js 的方式一樣即可，<br>但實際上並非如此，我們需要透過 <strong>Worklets</strong> 來幫我們載入。以上面的 Paint API 為例：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// add a Worklet</span></span><br><span class="line">paintWorklet.<span class="title function_">addModule</span>(<span class="string">&#x27;simpleRect.js&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// WORKLET &quot;simpleRect.js&quot;</span></span><br><span class="line"><span class="title function_">registerPaint</span>(<span class="string">&#x27;simpleRect&#x27;</span>, <span class="keyword">class</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">get</span> <span class="title function_">inputProperties</span>() &#123; <span class="keyword">return</span> [<span class="string">&#x27;--rect-color&#x27;</span>]; &#125;</span><br><span class="line">    <span class="title function_">paint</span>(<span class="params">ctx, size, properties</span>) &#123;</span><br><span class="line">        <span class="comment">// 依據 properties 改變顏色</span></span><br><span class="line">        <span class="keyword">const</span> color = properties.<span class="title function_">get</span>(<span class="string">&#x27;--rect-color&#x27;</span>);</span><br><span class="line">        ctx.<span class="property">fillStyle</span> = color.<span class="property">cssText</span>;</span><br><span class="line">        ctx.<span class="title function_">fillRect</span>(<span class="number">0</span>, <span class="number">0</span>, size.<span class="property">width</span>, size.<span class="property">height</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>同理，Layout API 則是 <code>layoutWorklet.addModule(&#39;blockLike.js&#39;)</code>。</p>
<p><strong>Worklets</strong> 光名字就有點像 Web Worker 了，都是獨立於主要執行緒之外，並且不直接與 DOM 互動。你可能會想那為何還需要有一個 Worklets？</p>
<p>因為 Houdini 是希望將開發者的程式碼 hook 到 CSS engine 中運作，而根據規範內的敘述，web worker 相對笨重，不適合用來處理 CSS engine 這種可能會牽扯到數百萬畫素圖片的工作。<br>所以可以推斷，Worklets 的特點就是輕量以及生命週期較短。</p>
<p>其實除了 Layout Worklets 與 Paint Worklets 外，還有所謂的 Animation Worklet，雖然還沒有放入規範，但已經有在著手進行中，也有 <a target="_blank" rel="noopener" href="https://github.com/GoogleChrome/houdini-samples/tree/master/animation-worklet">Polyfills</a> 了，Chrome 的 Sticky Header 就是採用 Houdini 的 Animation Worklet。Twitter 的 <a target="_blank" rel="noopener" href="https://blog.hospodarets.com/demos/houdini-anim-twitter/">Header Effect</a> 也是採用 Animation Worklet<br>Animation Worklet 是想介入 Render Pipeline 中的 Composite 步驟，也就是原本利用 js 與 css 控制動畫時，瀏覽器會重新執行的部分。<br>關於 Animation Worklet 的詳細實作介紹可以看這份投影片 <a target="_blank" rel="noopener" href="http://slides.com/malyw/houdini-codemotion#/48">houdini-codemotion</a></p>
<h2 id="CSS-Parser-API"><a href="#CSS-Parser-API" class="headerlink" title="CSS Parser API"></a>CSS Parser API</h2><p>Parser API 目前還是處在 Unofficial draft，但我相信如果這個 API 確認的話，對前端開發有絕對的幫助，她的概念是想讓開發者能擴充瀏覽器解析 HTML、CSS 的功能，<br>也就是說，你可以想辦法讓他看得懂最新定義的 pseudo-classes 或甚至是 element-queries 等等，這樣就能正確解析出 CSSOM，從此不用再等瀏覽器更新。</p>
<h2 id="CSS-Typed-OM"><a href="#CSS-Typed-OM" class="headerlink" title="CSS Typed OM"></a>CSS Typed OM</h2><p>CSS Typed OM 就是 CSSOM 的強化版，最主要的功能在於將 CSSOM 所使用的字串值轉換成具有型別意義的 JavaScript 表示形態，像是所有的 CSS Values 都有一個 base class interface：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">interface <span class="title class_">CSSStyleValue</span> &#123;</span><br><span class="line">    stringifier;</span><br><span class="line">    <span class="keyword">static</span> <span class="title class_">CSSStyleValue</span>? <span class="title function_">parse</span>(<span class="title class_">DOMString</span> property, <span class="title class_">DOMString</span> cssText);</span><br><span class="line">    <span class="keyword">static</span> sequence&lt;<span class="title class_">CSSStyleValue</span>&gt;? <span class="title function_">parseAll</span>(<span class="title class_">DOMString</span> property, <span class="title class_">DOMString</span> cssText);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>你可以如下操作 CSS style: (source from <a target="_blank" rel="noopener" href="http://slides.com/malyw/houdini-codemotion#/27">CSS Houdini- the bridge between CSS, JavaScript and the browser</a>)<br><em>source from [CSS Houdini- the bridge between CSS, JavaScript and the browser</em></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// CSS -&gt; JS</span></span><br><span class="line"><span class="keyword">const</span> map = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.example&#x27;</span>).<span class="property">styleMap</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>( map.<span class="title function_">get</span>(<span class="string">&#x27;font-size&#x27;</span>) );</span><br><span class="line"><span class="comment">// CSSSimpleLength &#123;value: 12, type: &quot;px&quot;, cssText: &quot;12px&quot;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// JS -&gt; JS</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>( <span class="keyword">new</span> <span class="title class_">CSSUnitValue</span>(<span class="number">5</span>, <span class="string">&quot;px&quot;</span>) );</span><br><span class="line"><span class="comment">// CSSUnitValue&#123;value:5,unit:&quot;px&quot;,type:&quot;length&quot;,cssText:&quot;5px&quot;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// JS -&gt; CSS</span></span><br><span class="line"><span class="comment">// set style &quot;transform: translate3d(0px, -72.0588%, 0px);&quot;</span></span><br><span class="line">elem.<span class="property">outputStyleMap</span>.<span class="title function_">set</span>(<span class="string">&#x27;transform&#x27;</span>,</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">CSSTransformValue</span>([</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">CSSTranslation</span>(</span><br><span class="line">          <span class="number">0</span>, <span class="keyword">new</span> <span class="title class_">CSSSimpleLength</span>(<span class="number">100</span> - currentPercent, <span class="string">&#x27;%&#x27;</span>), <span class="number">0</span></span><br><span class="line">        )]));</span><br></pre></td></tr></table></figure>

<p>根據 <a target="_blank" rel="noopener" href="https://drafts.css-houdini.org/css-typed-om/">Drafts 的內容</a>，有了型別定義，在 JavaScript 的操作上據說會有效能上的顯著提升。此外，CSS Typed OM 也應用在 Parser API 與 CSS Properties API 上。</p>
<h2 id="Font-Metrics-API"><a href="#Font-Metrics-API" class="headerlink" title="Font Metrics API"></a>Font Metrics API</h2><p>Font Metrics 也沒有出現在上方的 <strong>Houdini API on render pipeline</strong> 中，但它其實已經被寫入 <a target="_blank" rel="noopener" href="https://drafts.css-houdini.org/font-metrics-api/">Draft 規範</a> 中了。<br>老實說看不是很懂他的 spec 寫的內容，但我猜測這東西的用途應該跟這篇文章 <a target="_blank" rel="noopener" href="http://iamvdo.me/en/blog/css-font-metrics-line-height-and-vertical-align">Deep dive CSS: font metrics, line-height and vertical-align</a> 其中提到一個問題有關，（裡面非常詳細的介紹了 font metrics、line-height 與 vertical-align 在網頁上如何互相影響，推薦大家有空的話耐心閱讀一番。）：</p>
<p>不同 font-family 在相同 font-size 下，所產生的 span 高度會不同。</p>
<p><img src="/img/arvinh/font-size.png" alt="source from http://iamvdo.me/en/blog/css-font-metrics-line-height-and-vertical-align"><br><em>source from <a target="_blank" rel="noopener" href="http://iamvdo.me/en/blog/css-font-metrics-line-height-and-vertical-align">http://iamvdo.me/en/blog/css-font-metrics-line-height-and-vertical-align</a></em></p>
<p>要想控制 Font metrics，也就是控制字所佔的寬高的話，目前可以先用 CSS Properties 來處理，根據已知字體的 font-metrics 動態算出我們要 apply 多少的 font-size：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span> &#123;</span><br><span class="line">    <span class="comment">/* 定義好我們已知字型的 Font metrics */</span></span><br><span class="line">    <span class="comment">/* font metrics */</span></span><br><span class="line">    <span class="attr">--font</span>: Catamaran;</span><br><span class="line">    <span class="attr">--fm-capitalHeight</span>: <span class="number">0.68</span>;</span><br><span class="line">    <span class="attr">--fm-descender</span>: <span class="number">0.54</span>;</span><br><span class="line">    <span class="attr">--fm-ascender</span>: <span class="number">1.1</span>;</span><br><span class="line">    <span class="attr">--fm-linegap</span>: <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 定義想要的高度 */</span></span><br><span class="line">    <span class="attr">--capital-height</span>: <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 設定 font-family */</span></span><br><span class="line">    <span class="attribute">font-family</span>: <span class="built_in">var</span>(--font);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 利用 Font metrics 的資訊與想定義的高度來計算出 font-size */</span></span><br><span class="line">    <span class="attr">--computedFontSize</span>: (<span class="built_in">var</span>(--capital-height) / <span class="built_in">var</span>(--fm-capitalHeight));</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="built_in">calc</span>(<span class="built_in">var</span>(--computedFontSize) * <span class="number">1px</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>而想必 Font Metrics API 就是希望能 expose 出更方便的 API 來達成上述的事情。</p>
<h2 id="結論"><a href="#結論" class="headerlink" title="結論"></a>結論</h2><!-- JS 與 CSS 的發展速度剛好相反 -->
<p>Web 開發基本上就是由 HTML、JS、CSS 三大要素構成，然而 JS 與 CSS 的發展差異卻極其龐大，一個速度快到讓人跟不上，一個則是等半天還是無法放心使用新規格，實在非常有趣…<br>但透過這次了解 Houdini API 的過程，理解到了 CSS 算是朝向好的方向前進，雖然很多離實際採用還有段距離，但至少我們已經能夠在最新的瀏覽器上使用 Custom Properties 了！CSS 的未來還是充滿希望的！</p>
<h2 id="資料來源"><a href="#資料來源" class="headerlink" title="資料來源"></a>資料來源</h2><ol>
<li><a target="_blank" rel="noopener" href="http://slides.com/malyw/houdini-codemotion">CSS Houdini- the bridge between CSS, JavaScript and the browser</a>)</li>
<li><a target="_blank" rel="noopener" href="https://drafts.css-houdini.org/">Houdini Draft</a></li>
<li><a target="_blank" rel="noopener" href="http://iamvdo.me/en/blog/css-font-metrics-line-height-and-vertical-align">Deep dive CSS: font metrics, line-height and vertical-align</a></li>
<li><a target="_blank" rel="noopener" href="https://www.smashingmagazine.com/2016/03/houdini-maybe-the-most-exciting-development-in-css-youve-never-heard-of/">Houdini: Maybe The Most Exciting Development In CSS You’ve Never Heard Of</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/GoogleChrome/houdini-samples">houdini-samples</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/w3c/css-houdini-drafts">Houdini API Draft</a></li>
</ol>
<p>關於作者：<br><a target="_blank" rel="noopener" href="http://blog.arvinh.info/about/">@arvinh</a> 前端攻城獅，熱愛數據分析和資訊視覺化</p>
  
      <div>喜歡我們的文章嗎？歡迎分享按讚給予我們支持和鼓勵！</div>
      <div class="fb-like" data-href="https://blog.techbridge.cc/2017/05/23/css-houdini/index.html" data-layout="button_count" data-action="like" data-size="large" data-show-faces="false" data-share="true"></div>
      <br>
      <br>
      <div class="fb-page" data-href="https://www.facebook.com/techbridge.cc" data-small-header="false" data-adapt-container-width="true" data-hide-cover="false" data-show-facepile="true"><blockquote cite="https://www.facebook.com/techbridge.cc" class="fb-xfbml-parse-ignore"><a target="_blank" rel="noopener" href="https://www.facebook.com/techbridge.cc">TechBridge 技術日報</a></blockquote></div>
      <br>
    </section>
    <br>
    <hr>
    <div>
      <h4>訂閱 TechBridge Weekly 技術週刊，每週發送最精華的技術開發、產品設計的資訊給您</h4>
      <form class="form-control" method="post" action="https://goodbits.io/e/cab8a418-6b70-48d6-97ea-b5f0ef34b22c" target="_blank">
        <input class="form-control" type="text" name="first_name" placeholder="First Name"></input>
        <input class="form-control" type="text" name="last_name" placeholder="Last Name"></input>
        <div>
          <input class="form-control" type="text" name="email" placeholder="Email"></input>
        </div>
        <br>
        <div>
          <button class="form-control btn subscribe-btn" type="submit">馬上訂閱技術週刊</button>
        </div>
        <br>
        <label for="">PS. 我們討厭垃圾信，所以我們只提供有價值的內容給您 :)</label>
      </form>
    </div>
    <footer class="post-footer">
      <section class="author">
    <h4>TechBridge Weekly 技術週刊編輯團隊</h4>
    <p>TechBridge Weekly 技術週刊團隊是一群對用技術改變世界懷抱熱情的團隊。本技術共筆部落格初期專注於Web前後端、行動網路、機器人/物聯網、資料科學與產品設計等技術分享。This is TechBridge Weekly Team Tech Blog, which focus on web, mobile, robotics, IoT, Data Science technology sharing.</p>
    <span><a href="/2016/03/19/about/">關於我們</a></span> / <span><a href="https://www.techbridge.cc/" target="_blank">技術日報</a></span> / <span><a href="http://weekly.techbridge.cc/" target="_blank">技術週刊</a></span> / <span><a href="https://www.facebook.com/techbridge.cc/" target="_blank">粉絲專頁</a></span> / <span><a href="/atom.xml" target="_blank">訂閱RSS </a></span>   
	<div class="fb-like" data-href="https://www.facebook.com/techbridge.cc" data-layout="button_count" data-size="large" data-action="like" data-show-faces="false" data-share="true"></div>    
</section>
      <section class="share">
    <h4>Share this post</h4>
    <a class="icon-twitter" target="_blank" rel="noopener" href="http://twitter.com/share?url=https://blog.techbridge.cc/2017/05/23/css-houdini/"
       onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
        <span class="hidden">Twitter</span>
    </a>
    <a class="icon-facebook" target="_blank" rel="noopener" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.techbridge.cc/2017/05/23/css-houdini/"
       onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
        <span class="hidden">Facebook</span>
    </a>
    <a class="icon-google-plus" target="_blank" rel="noopener" href="https://plus.google.com/share?url=https://blog.techbridge.cc/2017/05/23/css-houdini/"
       onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
        <span class="hidden">Google+</span>
    </a>
    <iframe src="https://ghbtns.com/github-btn.html?user=TechBridgeHQ&repo=blog-starter-kit&type=star&count=true" frameborder="0" scrolling="0" width="170px" height="20px"></iframe>      
</section>
    </footer>
    <br>
  </article>
  <nav class="pagination" role="pagination">
    <h2>更多優質技術文章</h2>
    
    <a class="newer-posts" href="/2017/06/03/python-web-flask101-tutorial-introduction-and-environment-setup/">
        ← Python Web Flask 實戰開發教學 - 簡介與環境建置
    </a>
    
    <span class="page-number">•</span>
    
    <a class="older-posts" href="/2017/05/22/factory-method-and-abstract-factory/">
        設計模式 - 工廠方法及抽象工廠 →
    </a>
    
</nav>
  <div id="comment" class="comments-area">
    <h1 class="title"><a href="#disqus_comments" name="disqus_comments">留言討論</a></h1>

    
    <div id="disqus_thread">
        <noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>
    
</div>
</main>


  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-75308642-1', 'auto');
  ga('send', 'pageview');

</script>
<footer class="site-footer">
  
  <a class="subscribe icon-feed" href="/atom.xml"><span class="tooltip">Subscribe!</span></a>
  
  <div class="inner">
     <section class="copyright">All content copyright <a href="/">TechBridge 技術共筆部落格</a> &copy; 2017 &bull; All rights reserved.</section>
  </div>
</footer>

  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>

<script type="text/javascript" src="/js/jquery.fitvids.js"></script>
<script type="text/javascript" src="/js/index.js"></script>


<script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', '[object Object]']);
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
</script>


<script type="text/javascript">
    var disqus_shortname = 'techbridgeweekly';

    (function(){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.4/dist/medium-zoom.min.js"></script>
<script>
// NodeList
mediumZoom(document.querySelectorAll('img'));
</script>
  <div id="fb-root"></div>
	<script>(function(d, s, id) {
	  var js, fjs = d.getElementsByTagName(s)[0];
	  if (d.getElementById(id)) return;
	  js = d.createElement(s); js.id = id;
	  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.5";
	  fjs.parentNode.insertBefore(js, fjs);
	}(document, 'script', 'facebook-jssdk'));</script>
</body>
</html>
